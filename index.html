<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Soundify</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico"><!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script><!-- Google Sign-In -->
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #000000;
            color: #ffffff;
            height: 100vh;
            overflow: hidden;
        }
        
        .app-container {
            display: flex;
            height: 100vh;
        }
        
        .sidebar {
            width: 280px;
            background-color: #121212;
            border-right: 1px solid #282828;
            display: flex;
            flex-direction: column;
            padding: 24px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 32px;
            padding: 8px 0;
        }
        
        .logo-image {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            object-fit: cover;
            box-shadow: 0 4px 12px rgba(29, 185, 84, 0.3);
            transition: transform 0.2s ease;
        }
        
        .logo-image:hover {
            transform: scale(1.05);
        }
        
        .logo-text {
            font-size: 28px;
            font-weight: bold;
            color: #1db954;
            text-shadow: 0 2px 4px rgba(29, 185, 84, 0.2);
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-weight: 500;
        }
        
        .nav-item:hover {
            background-color: #1a1a1a;
        }
        
        .nav-item.active {
            background-color: #282828;
        }
        
        .nav-icon {
            width: 24px;
            height: 24px;
            margin-right: 16px;
            fill: currentColor;
        }
        
        .create-playlist-btn {
            background-color: #1db954;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 24px;
            font-weight: 600;
            cursor: pointer;
            margin: 16px 0;
            transition: background-color 0.2s;
        }
        
        .create-playlist-btn:hover {
            background-color: #1ed760;
        }
        
        .playlist-list {
            flex: 1;
            overflow-y: auto;
            margin-top: 16px;
        }
        
        .playlist-item {
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color 0.2s;
        }
        
        .playlist-item:hover {
            background-color: #1a1a1a;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: linear-gradient(180deg, #1a1a1a 0%, #121212 300px);
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 32px;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }
        
        .nav-buttons {
            display: flex;
            gap: 16px;
        }
        
        .nav-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #000;
            border: none;
            color: #b3b3b3;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .nav-btn:hover {
            color: white;
            transform: scale(1.05);
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .online-counter {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #b3b3b3;
            font-size: 14px;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 6px 12px;
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }
        
        .online-dot {
            width: 8px;
            height: 8px;
            background-color: #1db954;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .upgrade-btn {
            background-color: white;
            color: black;
            border: none;
            padding: 8px 24px;
            border-radius: 24px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .upgrade-btn:hover {
            transform: scale(1.05);
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #535353;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
        }
        
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 0 32px 100px 32px;
        }
        
        .hero-section {
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
            border-radius: 12px;
            padding: 48px;
            margin-bottom: 48px;
        }
        
        .hero-title {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 16px;
        }
        
        .hero-subtitle {
            font-size: 18px;
            opacity: 0.8;
        }
        
        .section {
            margin-bottom: 48px;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 24px;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 24px;
        }
        
        .card {
            background-color: #181818;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .card:hover {
            background-color: #282828;
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.25);
        }
        
        .card:active {
            transform: translateY(-2px) scale(0.98);
            transition: all 0.1s ease;
        }
        
        .card-image {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 8px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            position: relative;
            overflow: hidden;
        }
        
        .play-overlay {
            position: absolute;
            bottom: 8px;
            right: 8px;
            width: 48px;
            height: 48px;
            background-color: #1db954;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: translateY(8px);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .card:hover .play-overlay {
            opacity: 1;
            transform: translateY(0);
        }
        
        .card-title {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .card-subtitle {
            color: #b3b3b3;
            font-size: 14px;
        }
        
        .player-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #181818;
            border-top: 1px solid #282828;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .now-playing {
            display: flex;
            align-items: center;
            flex: 1;
            min-width: 0;
        }
        
        .track-info {
            margin-left: 16px;
            min-width: 0;
        }
        
        .track-name {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .track-artist {
            color: #b3b3b3;
            font-size: 12px;
        }
        
        .player-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            max-width: 600px;
        }
        
        .control-buttons {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 12px;
        }
        
        .control-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        .control-btn:hover {
            color: white;
            transform: scale(1.1);
        }
        
        .play-btn {
            background-color: white;
            color: black;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .play-btn:hover {
            transform: scale(1.05);
        }
        
        .progress-container {
            display: flex;
            align-items: center;
            width: 100%;
            gap: 12px;
        }
        
        .time {
            font-size: 12px;
            color: #b3b3b3;
            min-width: 40px;
        }
        
        .progress-bar {
            flex: 1;
            height: 4px;
            background-color: #535353;
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #1db954;
            border-radius: 2px;
            width: 0%;
            transition: width 0.1s;
        }
        
        .volume-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
            justify-content: flex-end;
        }
        
        .volume-bar {
            width: 100px;
            height: 4px;
            background-color: #535353;
            border-radius: 2px;
            cursor: pointer;
        }
        
        .volume-fill {
            height: 100%;
            background-color: #1db954;
            border-radius: 2px;
            width: 70%;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-content {
            background-color: #282828;
            padding: 32px;
            border-radius: 12px;
            width: 400px;
            max-width: 90vw;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 24px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #535353;
            border-radius: 8px;
            background-color: #121212;
            color: white;
            font-size: 16px;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #1db954;
        }
        
        .button-group {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background-color: #1db954;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1ed760;
        }
        
        .btn-secondary {
            background-color: transparent;
            color: #b3b3b3;
            border: 1px solid #535353;
        }
        
        .btn-secondary:hover {
            color: white;
            border-color: white;
        }
        
        .search-container {
            margin-bottom: 32px;
        }
        
        .search-input {
            width: 100%;
            max-width: 400px;
            padding: 12px 20px;
            border: none;
            border-radius: 24px;
            background-color: #242424;
            color: white;
            font-size: 16px;
        }
        
        .search-input:focus {
            outline: none;
            background-color: #2a2a2a;
        }
        
        .browse-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
        }
        
        .category-card {
            aspect-ratio: 1;
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: transform 0.2s;
            display: flex;
            align-items: flex-end;
        }
        
        .category-card:hover {
            transform: scale(1.05);
        }
        
        .category-title {
            font-size: 20px;
            font-weight: bold;
        }
        
        .hidden {
            display: none !important;
        }
        
        .loading {
            opacity: 0.6;
            pointer-events: none;
            position: relative;
        }
        
        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid #1db954;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-up {
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .toast {
            position: fixed;
            top: 24px;
            right: 24px;
            background-color: #1db954;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            z-index: 1001;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .auth-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
        }
        
        .auth-card {
            background-color: #121212;
            padding: 48px;
            border-radius: 12px;
            width: 400px;
            max-width: 90vw;
        }
        
        .auth-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            font-size: 32px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 32px;
            color: #1db954;
        }
        
        .auth-logo {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 6px 20px rgba(29, 185, 84, 0.4);
            animation: logoGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes logoGlow {
            from {
                box-shadow: 0 6px 20px rgba(29, 185, 84, 0.4);
            }
            to {
                box-shadow: 0 8px 25px rgba(29, 185, 84, 0.6);
            }
        }
        
        .auth-toggle {
            text-align: center;
            margin-top: 24px;
            color: #b3b3b3;
        }
        
        .auth-link {
            color: #1db954;
            cursor: pointer;
            text-decoration: underline;
        }
        
        .auth-link:hover {
            color: #1ed760;
        }
        
        .update-log {
            position: fixed;
            top: 80px;
            right: 24px;
            width: 350px;
            max-height: 500px;
            background-color: #181818;
            border: 1px solid #282828;
            border-radius: 12px;
            padding: 20px;
            z-index: 1000;
            overflow-y: auto;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .update-log.show {
            transform: translateX(0);
        }
        
        .update-log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #282828;
        }
        
        .update-log-title {
            font-size: 18px;
            font-weight: bold;
            color: #1db954;
        }
        
        .close-log-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: color 0.2s;
        }
        
        .close-log-btn:hover {
            color: white;
        }
        
        .log-entry {
            margin-bottom: 16px;
            padding: 12px;
            background-color: #121212;
            border-radius: 8px;
            border-left: 3px solid #1db954;
        }
        
        .log-entry.removed {
            border-left-color: #ff6b6b;
        }
        
        .log-entry.updated {
            border-left-color: #ffa500;
        }
        
        .log-date {
            font-size: 12px;
            color: #b3b3b3;
            margin-bottom: 8px;
        }
        
        .log-action {
            font-weight: 600;
            margin-bottom: 4px;
            color: #1db954;
        }
        
        .log-entry.removed .log-action {
            color: #ff6b6b;
        }
        
        .log-entry.updated .log-action {
            color: #ffa500;
        }
        
        .log-description {
            font-size: 14px;
            color: #e0e0e0;
            line-height: 1.4;
        }
        
        .watermark {
            text-align: center;
            padding: 12px;
            margin-top: 16px;
            border-top: 1px solid #282828;
            font-size: 12px;
            color: #535353;
        }
        
        .watermark .team-name {
            color: #1db954;
            font-weight: bold;
        }
        
        .update-log-toggle {
            background-color: #1db954;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .update-log-toggle:hover {
            background-color: #1ed760;
            transform: scale(1.05);
        }
        
        .feature-card {
            background: linear-gradient(135deg, #1e3a8a, #7c3aed);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }
        
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .feature-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 8px;
            color: white;
        }
        
        .feature-description {
            color: rgba(255,255,255,0.8);
            margin-bottom: 16px;
            line-height: 1.5;
        }
        
        .feature-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .feature-btn {
            background-color: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            backdrop-filter: blur(10px);
        }
        
        .feature-btn:hover {
            background-color: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background-color: #181818;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #282828;
        }
        
        .stat-number {
            font-size: 28px;
            font-weight: bold;
            color: #1db954;
            margin-bottom: 8px;
        }
        
        .stat-label {
            color: #b3b3b3;
            font-size: 14px;
        }
        
        .equalizer {
            display: flex;
            align-items: end;
            gap: 4px;
            height: 40px;
            margin: 0 12px;
        }
        
        .eq-bar {
            width: 4px;
            background-color: #1db954;
            border-radius: 2px;
            animation: bounce 1.5s ease-in-out infinite;
        }
        
        .eq-bar:nth-child(1) { height: 20px; animation-delay: 0s; }
        .eq-bar:nth-child(2) { height: 35px; animation-delay: 0.1s; }
        .eq-bar:nth-child(3) { height: 25px; animation-delay: 0.2s; }
        .eq-bar:nth-child(4) { height: 40px; animation-delay: 0.3s; }
        .eq-bar:nth-child(5) { height: 15px; animation-delay: 0.4s; }
        
        @keyframes bounce {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }
        
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                max-height: 200px;
                overflow-y: auto;
                border-right: none;
                border-bottom: 1px solid #282828;
                padding: 16px;
                position: relative;
                z-index: 10;
            }
            
            .sidebar .logo {
                margin-bottom: 16px;
            }
            
            .sidebar nav {
                display: flex;
                gap: 8px;
                overflow-x: auto;
                padding-bottom: 8px;
            }
            
            .nav-item {
                white-space: nowrap;
                min-width: auto;
                padding: 8px 16px;
                margin-bottom: 0;
            }
            
            .create-playlist-btn {
                display: none;
            }
            
            .playlist-list {
                display: none;
            }
            
            .main-content {
                flex: 1;
                min-height: 0;
            }
            
            .top-bar {
                padding: 12px 16px;
                flex-wrap: wrap;
                gap: 12px;
            }
            
            .user-menu {
                gap: 8px;
            }
            
            .online-counter {
                font-size: 12px;
                padding: 4px 8px;
            }
            
            .upgrade-btn {
                padding: 6px 16px;
                font-size: 14px;
            }
            
            .content-area {
                padding: 0 16px 120px 16px;
            }
            
            .hero-section {
                padding: 24px;
                margin-bottom: 24px;
            }
            
            .hero-title {
                font-size: 28px;
            }
            
            .hero-subtitle {
                font-size: 16px;
            }
            
            .grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 12px;
            }
            
            .browse-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 16px;
            }
            
            .player-bar {
                flex-direction: column;
                gap: 12px;
                padding: 12px 16px;
                height: auto;
            }
            
            .now-playing {
                order: 1;
                justify-content: center;
            }
            
            .player-controls {
                order: 2;
                max-width: 100%;
            }
            
            .volume-controls {
                order: 3;
                justify-content: center;
            }
            
            .control-buttons {
                gap: 20px;
                margin-bottom: 8px;
            }
            
            .progress-container {
                gap: 8px;
            }
            
            .time {
                min-width: 35px;
                font-size: 11px;
            }
            
            .modal-content {
                width: 90vw;
                padding: 24px;
                margin: 16px;
            }
            
            .auth-card {
                width: 90vw;
                padding: 32px 24px;
            }
            
            .auth-title {
                font-size: 24px;
            }
            
            .feature-card {
                padding: 20px;
            }
            
            .feature-title {
                font-size: 18px;
            }
            
            .feature-actions {
                gap: 8px;
            }
            
            .feature-btn {
                font-size: 12px;
                padding: 6px 12px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            
            .stat-card {
                padding: 16px;
            }
            
            .stat-number {
                font-size: 24px;
            }
            
            .update-log {
                width: 90vw;
                right: 5vw;
                max-height: 70vh;
            }
            
            .update-log-toggle {
                right: 16px;
                top: 16px;
                font-size: 11px;
                padding: 6px 12px;
            }
        }
        
        @media (max-width: 480px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .browse-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .hero-title {
                font-size: 24px;
            }
            
            .section-title {
                font-size: 20px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Authentication Screen -->
  <div id="auth-screen" class="auth-container">
   <div class="auth-card">
    <h1 id="auth-title" class="auth-title"><img src="logo.png" alt="Soundify Logo" class="auth-logo" onerror="this.style.display='none';"> <span>Soundify</span></h1>
    <form id="auth-form">
     <div class="form-group"><label class="form-label">Email</label> <input type="email" id="auth-email" class="form-input" required>
     </div>
     <div class="form-group"><label class="form-label">Password</label> <input type="password" id="auth-password" class="form-input" required>
     </div><button type="submit" id="auth-submit" class="btn btn-primary" style="width: 100%;"> Sign In </button>
    </form>
    <div style="text-align: center; margin: 24px 0; color: #535353;"><span>or</span>
    </div><button id="google-signin-btn" class="btn" style="width: 100%; background-color: white; color: black; display: flex; align-items: center; justify-content: center; gap: 12px;">
     <svg width="18" height="18" viewbox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" /> <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" /> <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" /> <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
     </svg> Continue with Google </button>
    <div class="auth-toggle"><span id="auth-toggle-text">Don't have an account?</span> <span id="auth-toggle-link" class="auth-link">Sign up</span>
    </div>
   </div>
  </div><!-- Main App -->
  <div id="main-app" class="app-container hidden"><!-- Sidebar -->
   <div class="sidebar">
    <div id="app-logo" class="logo"><img src="logo.png" alt="Soundify Logo" class="logo-image" onerror="this.style.display='none'; this.nextElementSibling.style.marginLeft='0';"> <span class="logo-text">Soundify</span>
    </div>
    <nav>
     <div class="nav-item active" onclick="showView('home')">
      <svg class="nav-icon" viewbox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
      </svg> Home
     </div>
     <div class="nav-item" onclick="showView('search')">
      <svg class="nav-icon" viewbox="0 0 24 24"><circle cx="11" cy="11" r="8" /> <path d="m21 21-4.35-4.35" />
      </svg> Search
     </div>
     <div class="nav-item" onclick="showView('library')">
      <svg class="nav-icon" viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z" />
      </svg> Your Library
     </div>
    </nav><button class="create-playlist-btn" onclick="openCreatePlaylistModal()"> Create Playlist </button>
    <div class="playlist-list" id="playlist-list"><!-- Playlists will be rendered here -->
    </div>
   </div><!-- Main Content -->
   <div class="main-content"><!-- Top Bar -->
    <div class="top-bar">
     <div class="nav-buttons"><button class="nav-btn">
       <svg width="16" height="16" viewbox="0 0 24 24" fill="currentColor"><path d="M15 18l-6-6 6-6" />
       </svg></button> <button class="nav-btn">
       <svg width="16" height="16" viewbox="0 0 24 24" fill="currentColor"><path d="M9 18l6-6-6-6" />
       </svg></button>
     </div>
     <div class="user-menu"><button class="update-log-toggle" onclick="toggleUpdateLog()"> üìã Updates </button>
      <div class="online-counter">
       <div class="online-dot"></div><span id="online-count">42</span> online
      </div><button class="upgrade-btn" onclick="openUpgradeModal()"> <span id="upgrade-text">Upgrade</span> </button>
      <div class="user-avatar" onclick="openProfileModal()"><span id="user-initial">U</span>
      </div>
     </div>
    </div><!-- Update Log Panel -->
    <div id="update-log" class="update-log">
     <div class="update-log-header">
      <div class="update-log-title">
       üîÑ Update Log
      </div><button class="close-log-btn" onclick="toggleUpdateLog()">
       <svg width="16" height="16" viewbox="0 0 24 24" fill="currentColor"><path d="M18 6L6 18M6 6l12 12" />
       </svg></button>
     </div>
     <div id="log-entries"><!-- Log entries will be populated here -->
     </div>
     <div class="watermark">
      Made with ‚ù§Ô∏è by <span class="team-name">Vesni &amp; Forca Team</span><br><small>Powered by Advanced AI Technology</small>
     </div>
    </div><!-- Content Area -->
    <div class="content-area"><!-- Home View -->
     <div id="home-view">
      <div class="hero-section">
       <h1 id="welcome-title" class="hero-title">Good evening</h1>
       <p class="hero-subtitle">Ready to discover your next favorite song?</p>
      </div>
      <div class="section">
       <h2 class="section-title">Recently played</h2>
       <div class="grid" id="recent-grid"><!-- Recent items will be rendered here -->
       </div>
      </div>
      <div class="section">
       <h2 class="section-title">Made for you</h2>
       <div class="grid" id="recommended-grid"><!-- Recommended items will be rendered here -->
       </div>
      </div><!-- Stats Section -->
      <div class="section">
       <h2 class="section-title">Your Music Stats</h2>
       <div class="stats-grid">
        <div class="stat-card">
         <div class="stat-number" id="total-tracks">
          6
         </div>
         <div class="stat-label">
          Total Tracks
         </div>
        </div>
        <div class="stat-card">
         <div class="stat-number" id="total-playlists">
          0
         </div>
         <div class="stat-label">
          Playlists
         </div>
        </div>
        <div class="stat-card">
         <div class="stat-number" id="listening-time">
          0h
         </div>
         <div class="stat-label">
          Listening Time
         </div>
        </div>
        <div class="stat-card">
         <div class="stat-number" id="favorite-genre">
          Electronic
         </div>
         <div class="stat-label">
          Top Genre
         </div>
        </div>
       </div>
      </div><!-- New Features Section -->
      <div class="section">
       <h2 class="section-title">üöÄ New Features</h2>
       <div class="feature-card">
        <div class="feature-title">
         üéµ YouTube Music Integration
        </div>
        <div class="feature-description">
         Connect real YouTube music to your tracks! Add YouTube video IDs to play actual songs instead of demo mode.
        </div>
        <div class="feature-actions"><button class="feature-btn" onclick="showYouTubeGuide()">üìñ Setup Guide</button> <button class="feature-btn" onclick="testYouTubeFeature()">üéß Test Feature</button>
        </div>
       </div>
       <div class="feature-card">
        <div class="feature-title">
         üìä Smart Analytics
        </div>
        <div class="feature-description">
         Track your listening habits, favorite genres, and music discovery patterns with detailed analytics.
        </div>
        <div class="feature-actions"><button class="feature-btn" onclick="showAnalytics()">üìà View Analytics</button> <button class="feature-btn" onclick="exportData()">üíæ Export Data</button>
        </div>
       </div>
       <div class="feature-card">
        <div class="feature-title">
         üé® Theme Customization
        </div>
        <div class="feature-description">
         Personalize your Soundify experience with custom themes, colors, and layout options.
        </div>
        <div class="feature-actions"><button class="feature-btn" onclick="openThemeEditor()">üé® Customize</button> <button class="feature-btn" onclick="resetTheme()">üîÑ Reset</button>
        </div>
       </div>
       <div class="feature-card">
        <div class="feature-title">
         üîä Audio Equalizer
        </div>
        <div class="feature-description">
         Fine-tune your audio experience with a built-in equalizer and audio enhancement tools.
        </div>
        <div class="feature-actions"><button class="feature-btn" onclick="openEqualizer()">üéõÔ∏è Open EQ</button> <button class="feature-btn" onclick="toggleBassBoost()">üîä Bass Boost</button>
        </div>
       </div>
       <div class="feature-card">
        <div class="feature-title">
         üé§ Voice Commands
        </div>
        <div class="feature-description">
         Control your music with voice commands. Say "Play", "Pause", "Next", or "Previous" to control playback.
        </div>
        <div class="feature-actions"><button class="feature-btn" onclick="toggleVoiceControl()">üé§ Enable Voice</button> <button class="feature-btn" onclick="testVoiceCommand()">üó£Ô∏è Test Command</button>
        </div>
       </div>
       <div class="feature-card">
        <div class="feature-title">
         üåô Sleep Timer
        </div>
        <div class="feature-description">
         Set a timer to automatically pause music after a specified duration. Perfect for bedtime listening.
        </div>
        <div class="feature-actions"><button class="feature-btn" onclick="setSleepTimer(15)">‚è∞ 15 min</button> <button class="feature-btn" onclick="setSleepTimer(30)">‚è∞ 30 min</button> <button class="feature-btn" onclick="setSleepTimer(60)">‚è∞ 1 hour</button>
        </div>
       </div>
       <div class="feature-card">
        <div class="feature-title">
         üéØ Smart Recommendations
        </div>
        <div class="feature-description">
         AI-powered music recommendations based on your listening history, mood, and time of day.
        </div>
        <div class="feature-actions"><button class="feature-btn" onclick="generateRecommendations()">ü§ñ Get Recommendations</button> <button class="feature-btn" onclick="setMoodFilter('chill')">üòå Chill Mode</button> <button class="feature-btn" onclick="setMoodFilter('energetic')">‚ö° Energy Mode</button>
        </div>
       </div>
       <div class="feature-card">
        <div class="feature-title">
         üé® Visualizer
        </div>
        <div class="feature-description">
         Beautiful audio visualizations that dance to your music. Multiple themes and effects available.
        </div>
        <div class="feature-actions"><button class="feature-btn" onclick="toggleVisualizer()">üåà Toggle Visualizer</button> <button class="feature-btn" onclick="changeVisualizerTheme()">üé≠ Change Theme</button>
        </div>
       </div>
       <div class="feature-card">
        <div class="feature-title">
         üì± Social Features
        </div>
        <div class="feature-description">
         Share your music, see what friends are listening to, and collaborate on playlists together.
        </div>
        <div class="feature-actions"><button class="feature-btn" onclick="shareCurrentTrack()">üì§ Share Track</button> <button class="feature-btn" onclick="viewFriendsActivity()">üë• Friends Activity</button> <button class="feature-btn" onclick="createCollaborativePlaylist()">ü§ù Collab Playlist</button>
        </div>
       </div>
      </div>
     </div><!-- Search View -->
     <div id="search-view" class="hidden">
      <div class="search-container"><input type="text" class="search-input" placeholder="What do you want to listen to?" oninput="performSearch(this.value)">
      </div>
      <div id="search-results" class="hidden">
       <h2 class="section-title">Search Results</h2>
       <div id="search-content"></div>
      </div>
      <div id="browse-section">
       <h2 class="section-title">Browse all</h2>
       <div class="browse-grid">
        <div class="category-card" style="background: linear-gradient(135deg, #ff6b6b, #ee5a24);">
         <div class="category-title">
          Pop
         </div>
        </div>
        <div class="category-card" style="background: linear-gradient(135deg, #4834d4, #686de0);">
         <div class="category-title">
          Rock
         </div>
        </div>
        <div class="category-card" style="background: linear-gradient(135deg, #00d2d3, #54a0ff);">
         <div class="category-title">
          Hip-Hop
         </div>
        </div>
        <div class="category-card" style="background: linear-gradient(135deg, #ff9ff3, #f368e0);">
         <div class="category-title">
          Electronic
         </div>
        </div>
       </div>
      </div>
     </div><!-- Library View -->
     <div id="library-view" class="hidden">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
       <h2 class="section-title" style="margin-bottom: 0;">Your Library</h2><button class="btn btn-primary" onclick="openCreatePlaylistModal()"> Create Playlist </button>
      </div>
      <div id="library-content"><!-- Library content will be rendered here -->
      </div>
     </div>
    </div>
   </div>
  </div><!-- Hidden YouTube Player -->
  <div id="youtube-player" style="position: absolute; top: -9999px; left: -9999px;"></div><!-- Player Bar -->
  <div id="player-bar" class="player-bar hidden">
   <div class="now-playing">
    <div id="current-track-image" class="card-image" style="width: 56px; height: 56px; margin-bottom: 0; background: linear-gradient(135deg, #535353, #181818);">
     üéµ
    </div>
    <div class="track-info">
     <div id="current-track-name" class="track-name">
      Select a song
     </div>
     <div id="current-track-artist" class="track-artist">
      No artist
     </div>
    </div>
   </div>
   <div class="player-controls">
    <div class="control-buttons"><button class="control-btn" onclick="previousTrack()">
      <svg width="16" height="16" viewbox="0 0 24 24" fill="currentColor"><path d="M6 4l10 8-10 8V4z" /> <path d="M6 4l10 8-10 8V4z" transform="translate(-4,0)" />
      </svg></button> <button id="play-pause-btn" class="control-btn play-btn" onclick="togglePlayPause()">
      <svg id="play-icon" width="16" height="16" viewbox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z" />
      </svg>
      <svg id="pause-icon" width="16" height="16" viewbox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z" />
      </svg></button> <button class="control-btn" onclick="nextTrack()">
      <svg width="16" height="16" viewbox="0 0 24 24" fill="currentColor"><path d="M18 4l-10 8 10 8V4z" /> <path d="M18 4l-10 8 10 8V4z" transform="translate(4,0)" />
      </svg></button> <!-- Animated Equalizer -->
     <div class="equalizer" id="equalizer" style="display: none;">
      <div class="eq-bar"></div>
      <div class="eq-bar"></div>
      <div class="eq-bar"></div>
      <div class="eq-bar"></div>
      <div class="eq-bar"></div>
     </div>
    </div>
    <div class="progress-container"><span id="current-time" class="time">0:00</span>
     <div class="progress-bar" onclick="seekTo(event)">
      <div id="progress-fill" class="progress-fill"></div>
     </div><span id="total-time" class="time">0:00</span>
    </div>
   </div>
   <div class="volume-controls"><button class="control-btn">
     <svg width="16" height="16" viewbox="0 0 24 24" fill="currentColor"><path d="M11 5L6 9H2v6h4l5 4V5z" /> <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07" />
     </svg></button>
    <div class="volume-bar">
     <div class="volume-fill"></div>
    </div>
   </div>
  </div><!-- Create Playlist Modal -->
  <div id="playlist-modal" class="modal hidden">
   <div class="modal-content">
    <h3 class="modal-title">Create Playlist</h3>
    <form id="playlist-form">
     <div class="form-group"><label class="form-label">Playlist Name</label> <input type="text" id="playlist-name" class="form-input" placeholder="My Playlist" required>
     </div>
     <div class="form-group"><label class="form-label">Description (Optional)</label> <input type="text" id="playlist-description" class="form-input" placeholder="Add a description">
     </div>
     <div class="form-group"><label class="form-label">Privacy</label> <select id="playlist-privacy" class="form-input"> <option value="private">üîí Private - Only you can see this</option> <option value="public">üåç Public - Everyone can see this</option> </select>
     </div>
     <div class="button-group"><button type="button" class="btn btn-secondary" onclick="closeCreatePlaylistModal()"> Cancel </button> <button type="submit" class="btn btn-primary"> Create </button>
     </div>
    </form>
   </div>
  </div><!-- Profile Modal -->
  <div id="profile-modal" class="modal hidden">
   <div class="modal-content">
    <h3 class="modal-title">Profile Settings</h3>
    <form id="profile-form">
     <div class="form-group"><label class="form-label">Display Name</label> <input type="text" id="profile-name" class="form-input" placeholder="Your Name">
     </div>
     <div class="form-group"><label class="form-label">Bio</label> <textarea id="profile-bio" class="form-input" placeholder="Tell us about yourself..." rows="3"></textarea>
     </div>
     <div class="form-group"><label class="form-label">Favorite Genre</label> <select id="profile-genre" class="form-input"> <option value="Electronic">Electronic</option> <option value="Pop">Pop</option> <option value="Rock">Rock</option> <option value="Hip-Hop">Hip-Hop</option> <option value="Jazz">Jazz</option> <option value="Classical">Classical</option> </select>
     </div>
     <div class="form-group">
      <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px; background-color: #181818; border-radius: 8px; margin-bottom: 16px;">
       <div>
        <div style="font-weight: 600; color: #1db954;">
         Account Status
        </div>
        <div style="color: #b3b3b3; font-size: 14px;" id="account-status">
         Free Plan - 4 hours daily limit
        </div>
       </div>
       <div style="color: #1db954; font-weight: bold;" id="usage-time">
        0h used today
       </div>
      </div>
     </div>
     <div class="button-group"><button type="button" class="btn btn-secondary" onclick="closeProfileModal()"> Cancel </button> <button type="button" class="btn" style="background-color: #ff4757; color: white;" onclick="signOut()"> Sign Out </button> <button type="submit" class="btn btn-primary"> Save Changes </button>
     </div>
    </form>
   </div>
  </div><!-- Upgrade Modal -->
  <div id="upgrade-modal" class="modal hidden">
   <div class="modal-content" style="max-width: 500px;">
    <h3 class="modal-title">üöÄ Upgrade to Premium</h3>
    <div style="background: linear-gradient(135deg, #1db954, #1ed760); padding: 24px; border-radius: 12px; margin-bottom: 24px; text-align: center;">
     <h2 style="margin: 0 0 8px 0; font-size: 28px;">Soundify Premium</h2>
     <p style="margin: 0; opacity: 0.9;">Unlimited music, unlimited possibilities</p>
    </div>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px;">
     <div style="padding: 20px; background-color: #181818; border-radius: 8px; border: 2px solid #282828;">
      <h4 style="color: #b3b3b3; margin: 0 0 16px 0;">Free Plan</h4>
      <div style="font-size: 24px; font-weight: bold; margin-bottom: 16px;">
       $0<span style="font-size: 14px; color: #b3b3b3;">/month</span>
      </div>
      <ul style="list-style: none; padding: 0; margin: 0;">
       <li style="margin-bottom: 8px; color: #b3b3b3;">‚è∞ 4 hours daily limit</li>
       <li style="margin-bottom: 8px; color: #b3b3b3;">üì± Basic features</li>
       <li style="margin-bottom: 8px; color: #b3b3b3;">üéµ Limited playlists</li>
      </ul>
     </div>
     <div style="padding: 20px; background-color: #181818; border-radius: 8px; border: 2px solid #1db954;">
      <h4 style="color: #1db954; margin: 0 0 16px 0;">Premium Plan</h4>
      <div style="font-size: 24px; font-weight: bold; margin-bottom: 16px;">
       $9.99<span style="font-size: 14px; color: #b3b3b3;">/month</span>
      </div>
      <ul style="list-style: none; padding: 0; margin: 0;">
       <li style="margin-bottom: 8px; color: #1db954;">‚è∞ Unlimited listening</li>
       <li style="margin-bottom: 8px; color: #1db954;">üéµ Unlimited playlists</li>
       <li style="margin-bottom: 8px; color: #1db954;">üé® Premium themes</li>
       <li style="margin-bottom: 8px; color: #1db954;">üîä High-quality audio</li>
       <li style="margin-bottom: 8px; color: #1db954;">üì± Priority support</li>
      </ul>
     </div>
    </div>
    <div id="admin-upgrade-section" class="hidden" style="background-color: #ff4757; padding: 16px; border-radius: 8px; margin-bottom: 16px;">
     <h4 style="margin: 0 0 12px 0; color: white;">üîê Admin Controls</h4>
     <div style="display: flex; gap: 12px;"><button class="btn" style="background-color: white; color: #ff4757;" onclick="grantPremium()"> Grant Premium </button> <button class="btn" style="background-color: rgba(255,255,255,0.2); color: white;" onclick="revokePremium()"> Revoke Premium </button>
     </div>
    </div>
    <div class="button-group"><button type="button" class="btn btn-secondary" onclick="closeUpgradeModal()"> Maybe Later </button> <button type="button" class="btn btn-primary" onclick="upgradeToPremium()" id="upgrade-action-btn"> Upgrade Now </button>
    </div>
   </div>
  </div>
  <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAPei3-puz3fsbrhk0s6l6rZGd30Mly2kk",
            authDomain: "soundify-67929.firebaseapp.com",
            projectId: "soundify-67929",
            storageBucket: "soundify-67929.firebasestorage.app",
            messagingSenderId: "278902873913",
            appId: "1:278902873913:web:a198391fee0ea00d78d2e8"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // Google Auth Provider
        const googleProvider = new firebase.auth.GoogleAuthProvider();
        googleProvider.addScope('email');
        googleProvider.addScope('profile');

        // Configuration
        const defaultConfig = {
            app_name: "Soundify",
            welcome_message: "Good evening"
        };

        // App State
        let currentUser = null;
        let currentView = 'home';
        let isPlaying = false;
        let currentTrack = null;
        let currentTime = 0;
        let totalTime = 180;
        let playlists = [];
        let isAuthMode = true;
        let currentTrackIndex = 0;
        let listeningTime = 0;
        let updateLogVisible = false;
        let bassBoostEnabled = false;
        let voiceControlEnabled = false;
        let sleepTimer = null;
        let visualizerEnabled = false;
        let currentMoodFilter = 'all';
        
        // User Management
        let userProfile = {
            displayName: '',
            bio: '',
            favoriteGenre: 'Electronic',
            isPremium: false,
            dailyUsage: 0,
            lastUsageReset: new Date().toDateString()
        };
        
        // Admin users (only these emails can grant premium)
        const adminEmails = [
            'vesni277@gmail.com'
        ];
        
        // Usage tracking
        let usageStartTime = null;
        let usageInterval = null;
        
        // Local storage state
        let localStorageAvailable = true;
        
        // Update Log System
        const updateLog = [
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üîê Google Authentication - Sign in with your Google account for seamless access'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üë• Online Users Counter - See how many users are currently active (3-78 users online)'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üé§ Voice Commands - Control music with voice: "Play", "Pause", "Next", "Previous"'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üåô Sleep Timer - Auto-pause music after 15min, 30min, or 1 hour for bedtime listening'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üéØ Smart AI Recommendations - Mood-based suggestions: Chill, Energetic, Focus, Party modes'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üåà Audio Visualizer - Beautiful animations that dance to your music with multiple themes'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üì± Social Features - Share tracks, view friends activity, create collaborative playlists'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üéµ YouTube Music Integration - Connect real YouTube videos to play actual music instead of demo tracks'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üìã Update Log System - Track all new features, updates, and improvements automatically'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üìä Music Statistics - View your listening habits, total tracks, playlists, and favorite genres'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üé® Enhanced UI Features - Beautiful feature cards, animated equalizer, and improved player controls'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: '‚è≠Ô∏è Track Navigation - Previous/Next track buttons with smart playlist navigation'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üîä Audio Equalizer - Visual equalizer animation that responds to music playback'
            },
            {
                date: new Date().toLocaleDateString(),
                action: 'ADDED',
                type: 'added',
                description: 'üéõÔ∏è Advanced Features - Theme customization, analytics export, and bass boost options'
            }
        ];

        // YouTube Music Template - Replace with your own tracks
        // To add YouTube music:
        // 1. Find a YouTube video URL (e.g., https://www.youtube.com/watch?v=VIDEO_ID)
        // 2. Extract the VIDEO_ID from the URL
        // 3. Add it to the youtubeId field below
        // 4. Update title, artist, album, duration, and genre accordingly
        
        const sampleTracks = [
            { 
                id: '1', 
                title: 'Midnight Dreams', 
                artist: 'Luna Eclipse', 
                album: 'Nocturnal', 
                duration: '3:24', 
                genre: 'Electronic',
                youtubeId: null // Add YouTube video ID here (e.g., 'dQw4w9WgXcQ')
            },
            { 
                id: '2', 
                title: 'Neon Lights', 
                artist: 'Cyber Wave', 
                album: 'Digital Future', 
                duration: '4:12', 
                genre: 'Synthwave',
                youtubeId: null // Add YouTube video ID here
            },
            { 
                id: '3', 
                title: 'Ocean Breeze', 
                artist: 'Chill Masters', 
                album: 'Relaxation', 
                duration: '3:45', 
                genre: 'Ambient',
                youtubeId: null // Add YouTube video ID here
            },
            { 
                id: '4', 
                title: 'Thunder Road', 
                artist: 'Rock Legends', 
                album: 'Greatest Hits', 
                duration: '4:33', 
                genre: 'Rock',
                youtubeId: null // Add YouTube video ID here
            },
            { 
                id: '5', 
                title: 'Summer Vibes', 
                artist: 'Pop Stars', 
                album: 'Seasonal', 
                duration: '3:18', 
                genre: 'Pop',
                youtubeId: null // Add YouTube video ID here
            },
            { 
                id: '6', 
                title: 'Bass Drop', 
                artist: 'EDM Producer', 
                album: 'Club Mix', 
                duration: '5:02', 
                genre: 'Electronic',
                youtubeId: null // Add YouTube video ID here
            }
        ];

        // Authentication Functions
        function toggleAuthMode() {
            isAuthMode = !isAuthMode;
            const submitBtn = document.getElementById('auth-submit');
            const toggleText = document.getElementById('auth-toggle-text');
            const toggleLink = document.getElementById('auth-toggle-link');
            
            if (isAuthMode) {
                submitBtn.textContent = 'Sign In';
                toggleText.textContent = "Don't have an account?";
                toggleLink.textContent = 'Sign up';
            } else {
                submitBtn.textContent = 'Sign Up';
                toggleText.textContent = 'Already have an account?';
                toggleLink.textContent = 'Sign in';
            }
        }

        async function handleAuth(event) {
            event.preventDefault();
            
            const email = document.getElementById('auth-email').value;
            const password = document.getElementById('auth-password').value;
            const submitBtn = document.getElementById('auth-submit');
            
            submitBtn.classList.add('loading');
            submitBtn.textContent = isAuthMode ? 'Signing In...' : 'Signing Up...';
            
            try {
                if (isAuthMode) {
                    await auth.signInWithEmailAndPassword(email, password);
                } else {
                    await auth.createUserWithEmailAndPassword(email, password);
                }
            } catch (error) {
                showToast(error.message);
                submitBtn.classList.remove('loading');
                submitBtn.textContent = isAuthMode ? 'Sign In' : 'Sign Up';
            }
        }

        async function signInWithGoogle() {
            try {
                const result = await auth.signInWithPopup(googleProvider);
                const user = result.user;
                showToast(`Welcome ${user.displayName}!`);
                addUpdateLogEntry('SIGNED IN', 'updated', `üîê User signed in with Google: ${user.displayName}`);
            } catch (error) {
                showToast('Google sign-in failed: ' + error.message);
                console.error('Google sign-in error:', error);
            }
        }

        async function signOut() {
            try {
                await auth.signOut();
                addUpdateLogEntry('SIGNED OUT', 'updated', 'üîê User signed out successfully');
            } catch (error) {
                showToast('Error signing out');
            }
        }

        // Auth State Observer
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                document.getElementById('auth-screen').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                document.getElementById('player-bar').classList.remove('hidden');
                
                // Set user initial
                const initial = user.displayName ? user.displayName.charAt(0).toUpperCase() : user.email.charAt(0).toUpperCase();
                document.getElementById('user-initial').textContent = initial;
                
                // Load user data and profile
                loadUserProfile();
                loadUserPlaylists();
                renderHomeContent();
                updateUpgradeButton();
                updateUsageDisplay();
                
                // Check if user is admin
                if (adminEmails.includes(user.email)) {
                    showToast('üëë Admin access detected - Premium controls available');
                }
            } else {
                currentUser = null;
                document.getElementById('auth-screen').classList.remove('hidden');
                document.getElementById('main-app').classList.add('hidden');
                document.getElementById('player-bar').classList.add('hidden');
                
                // Stop usage tracking on sign out
                stopUsageTracking();
            }
        });

        // Fallback data handler for local storage
        function savePlaylistsToLocal() {
            try {
                localStorage.setItem('soundify_playlists', JSON.stringify(playlists));
            } catch (error) {
                console.error('Error saving to localStorage:', error);
            }
        }
        
        function loadPlaylistsFromLocal() {
            try {
                const saved = localStorage.getItem('soundify_playlists');
                if (saved) {
                    playlists = JSON.parse(saved);
                    renderPlaylists();
                    renderLibrary();
                    updateStats();
                }
            } catch (error) {
                console.error('Error loading from localStorage:', error);
                playlists = [];
            }
        }
        
        // Load playlists function
        async function loadUserPlaylists() {
            if (!currentUser) return;
            
            // First load from localStorage
            loadPlaylistsFromLocal();
            
            // Then try to sync with Firestore
            try {
                const snapshot = await db.collection('playlists')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .get();
                
                const firestorePlaylists = snapshot.docs.map(doc => ({
                    id: doc.data().id || doc.id,
                    ...doc.data(),
                    tracks: doc.data().tracks ? JSON.parse(doc.data().tracks) : []
                }));
                
                // Merge with local playlists (Firestore takes priority for conflicts)
                const localIds = playlists.map(p => p.id);
                const newFromFirestore = firestorePlaylists.filter(p => !localIds.includes(p.id));
                
                if (newFromFirestore.length > 0) {
                    playlists = [...playlists, ...newFromFirestore];
                    savePlaylistsToLocal();
                    renderPlaylists();
                    renderLibrary();
                    updateStats();
                }
            } catch (error) {
                console.log('Firestore sync failed, using local storage only');
            }
        }

        async function createPlaylist(name, description = '', privacy = 'private') {
            if (!currentUser) return;
            
            // Check data limit (free users limited to 10 playlists)
            const maxPlaylists = userProfile.isPremium ? 50 : 10;
            if (playlists.length >= maxPlaylists) {
                showToast(`Maximum limit of ${maxPlaylists} playlists reached. ${!userProfile.isPremium ? 'Upgrade to Premium for more!' : 'Please delete some playlists first.'}`);
                return;
            }
            
            const playlistData = {
                id: Date.now().toString(),
                name: name,
                description: description,
                privacy: privacy,
                userId: currentUser.uid,
                tracks: [],
                createdAt: new Date().toISOString(),
                type: 'playlist'
            };
            
            try {
                // Add to local array
                playlists.push(playlistData);
                
                // Save to localStorage
                savePlaylistsToLocal();
                
                // Try to save to Firestore as backup
                try {
                    await db.collection('playlists').add({
                        ...playlistData,
                        tracks: JSON.stringify(playlistData.tracks),
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                } catch (firestoreError) {
                    console.log('Firestore save failed, using local storage only');
                }
                
                renderPlaylists();
                renderLibrary();
                updateStats();
                showToast(`‚úÖ Playlist "${name}" created and saved locally!`);
            } catch (error) {
                showToast('Error creating playlist');
                console.error('Error creating playlist:', error);
            }
        }

        async function deletePlaylist(playlistId) {
            if (!currentUser) return;
            
            try {
                // Remove from local array
                playlists = playlists.filter(p => p.id !== playlistId);
                
                // Save to localStorage
                savePlaylistsToLocal();
                
                // Try to delete from Firestore as backup
                try {
                    const snapshot = await db.collection('playlists')
                        .where('userId', '==', currentUser.uid)
                        .where('id', '==', playlistId)
                        .get();
                    
                    snapshot.docs.forEach(doc => {
                        doc.ref.delete();
                    });
                } catch (firestoreError) {
                    console.log('Firestore delete failed, using local storage only');
                }
                
                renderPlaylists();
                renderLibrary();
                updateStats();
                showToast('‚úÖ Playlist deleted successfully!');
            } catch (error) {
                showToast('Error deleting playlist');
                console.error('Error deleting playlist:', error);
            }
        }

        // UI Functions
        function showView(view) {
            // Hide all views
            document.getElementById('home-view').classList.add('hidden');
            document.getElementById('search-view').classList.add('hidden');
            document.getElementById('library-view').classList.add('hidden');
            
            // Show selected view
            document.getElementById(view + '-view').classList.remove('hidden');
            currentView = view;
            
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function renderHomeContent() {
            // Add loading state
            const recentGrid = document.getElementById('recent-grid');
            const recommendedGrid = document.getElementById('recommended-grid');
            
            recentGrid.classList.add('loading');
            recommendedGrid.classList.add('loading');
            
            // Simulate async loading for better UX
            setTimeout(() => {
                // Render recent tracks with fade-in animation
                recentGrid.innerHTML = '';
                recentGrid.classList.remove('loading');
                
                sampleTracks.slice(0, 6).forEach((track, index) => {
                    setTimeout(() => {
                        const card = createTrackCard(track);
                        card.classList.add('fade-in');
                        recentGrid.appendChild(card);
                    }, index * 100); // Stagger animations
                });
                
                // Render recommended content
                recommendedGrid.innerHTML = '';
                recommendedGrid.classList.remove('loading');
                
                const recommendations = [
                    { title: 'Daily Mix 1', subtitle: 'Electronic, Ambient', gradient: 'linear-gradient(135deg, #1db954, #1ed760)' },
                    { title: 'Discover Weekly', subtitle: 'Your weekly mixtape', gradient: 'linear-gradient(135deg, #ff6b6b, #ee5a24)' },
                    { title: 'Release Radar', subtitle: 'New releases for you', gradient: 'linear-gradient(135deg, #4834d4, #686de0)' }
                ];
                
                recommendations.forEach((item, index) => {
                    setTimeout(() => {
                        const card = document.createElement('div');
                        card.className = 'card fade-in';
                        card.innerHTML = `
                            <div class="card-image" style="background: ${item.gradient};">
                                üéµ
                                <div class="play-overlay" onclick="playRecommendation('${item.title}')">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M8 5v14l11-7z"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="card-title">${item.title}</div>
                            <div class="card-subtitle">${item.subtitle}</div>
                        `;
                        recommendedGrid.appendChild(card);
                    }, (index + 6) * 100); // Continue stagger after recent tracks
                });
            }, 300);
        }

        function createTrackCard(track) {
            const card = document.createElement('div');
            card.className = 'card';
            
            const gradients = [
                'linear-gradient(135deg, #667eea, #764ba2)',
                'linear-gradient(135deg, #f093fb, #f5576c)',
                'linear-gradient(135deg, #4facfe, #00f2fe)',
                'linear-gradient(135deg, #43e97b, #38f9d7)',
                'linear-gradient(135deg, #fa709a, #fee140)',
                'linear-gradient(135deg, #a8edea, #fed6e3)'
            ];
            
            const gradient = gradients[Math.floor(Math.random() * gradients.length)];
            
            card.innerHTML = `
                <div class="card-image" style="background: ${gradient};">
                    üéµ
                    <div class="play-overlay" onclick="playTrack('${track.id}')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                    </div>
                </div>
                <div class="card-title">${track.title}</div>
                <div class="card-subtitle">${track.artist}</div>
            `;
            
            return card;
        }

        function renderPlaylists() {
            const playlistList = document.getElementById('playlist-list');
            playlistList.innerHTML = '';
            
            playlists.forEach(playlist => {
                const item = document.createElement('div');
                item.className = 'playlist-item';
                item.innerHTML = `
                    <span>${playlist.name}</span>
                    <button onclick="deletePlaylist('${playlist.id}')" style="background: none; border: none; color: #b3b3b3; cursor: pointer; padding: 4px;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 6h18l-1.5 14H4.5L3 6zm5-4h8v2H8V2z"/>
                        </svg>
                    </button>
                `;
                item.onclick = (e) => {
                    if (e.target.tagName !== 'BUTTON' && e.target.tagName !== 'svg' && e.target.tagName !== 'path') {
                        openPlaylist(playlist);
                    }
                };
                playlistList.appendChild(item);
            });
        }

        function renderLibrary() {
            const libraryContent = document.getElementById('library-content');
            libraryContent.innerHTML = '';
            
            if (playlists.length === 0) {
                libraryContent.innerHTML = `
                    <div style="text-align: center; padding: 48px; color: #b3b3b3;">
                        <h3>Create your first playlist</h3>
                        <p>It's easy, we'll help you</p>
                        <button class="btn btn-primary" onclick="openCreatePlaylistModal()" style="margin-top: 16px;">
                            Create Playlist
                        </button>
                    </div>
                `;
                return;
            }
            
            playlists.forEach(playlist => {
                const privacyIcon = playlist.privacy === 'public' ? 'üåç' : 'üîí';
                const privacyText = playlist.privacy === 'public' ? 'Public' : 'Private';
                
                const item = document.createElement('div');
                item.className = 'card';
                item.style.marginBottom = '16px';
                item.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 16px;">
                        <div class="card-image" style="width: 64px; height: 64px; margin-bottom: 0; background: linear-gradient(135deg, #1db954, #1ed760);">
                            üìù
                        </div>
                        <div style="flex: 1;">
                            <div class="card-title">${playlist.name} ${privacyIcon}</div>
                            <div class="card-subtitle">${playlist.description || 'Playlist'} ‚Ä¢ ${playlist.tracks?.length || 0} songs ‚Ä¢ ${privacyText}</div>
                        </div>
                        <button onclick="deletePlaylist('${playlist.id}')" class="btn btn-secondary" style="padding: 8px 16px;">
                            Delete
                        </button>
                    </div>
                `;
                libraryContent.appendChild(item);
            });
        }

        // YouTube Player Integration
        let youtubePlayer = null;
        let playerReady = false;

        // Load YouTube IFrame API
        function loadYouTubeAPI() {
            if (!window.YT) {
                const tag = document.createElement('script');
                tag.src = 'https://www.youtube.com/iframe_api';
                const firstScriptTag = document.getElementsByTagName('script')[0];
                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
            }
        }

        // YouTube API ready callback
        window.onYouTubeIframeAPIReady = function() {
            youtubePlayer = new YT.Player('youtube-player', {
                height: '0',
                width: '0',
                playerVars: {
                    'playsinline': 1,
                    'controls': 0,
                    'disablekb': 1,
                    'fs': 0,
                    'modestbranding': 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        };

        function onPlayerReady(event) {
            playerReady = true;
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                updatePlayButton();
                startProgressTracking();
            } else if (event.data === YT.PlayerState.PAUSED) {
                isPlaying = false;
                updatePlayButton();
                stopProgressTracking();
            } else if (event.data === YT.PlayerState.ENDED) {
                isPlaying = false;
                updatePlayButton();
                currentTime = 0;
                updateProgressBar();
            }
        }

        let progressInterval;

        function startProgressTracking() {
            if (progressInterval) clearInterval(progressInterval);
            progressInterval = setInterval(() => {
                if (youtubePlayer && playerReady && isPlaying) {
                    currentTime = Math.floor(youtubePlayer.getCurrentTime());
                    totalTime = Math.floor(youtubePlayer.getDuration());
                    updateProgressBar();
                }
            }, 1000);
        }

        function stopProgressTracking() {
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }
        }

        function updatePlayButton() {
            const playIcon = document.getElementById('play-icon');
            const pauseIcon = document.getElementById('pause-icon');
            
            if (isPlaying) {
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
            } else {
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
            }
        }

        // Player Functions
        function playTrack(trackId) {
            // Check usage limit for free users
            if (!userProfile.isPremium && !startUsageTracking()) {
                return; // Usage limit reached
            }
            
            const track = sampleTracks.find(t => t.id === trackId);
            if (!track) return;
            
            currentTrack = track;
            document.getElementById('current-track-name').textContent = track.title;
            document.getElementById('current-track-artist').textContent = track.artist;
            document.getElementById('total-time').textContent = track.duration;
            
            // If track has YouTube ID, play it
            if (track.youtubeId && youtubePlayer && playerReady) {
                youtubePlayer.loadVideoById(track.youtubeId);
                showToast(`Playing: ${track.title}`);
            } else if (track.youtubeId && !playerReady) {
                showToast('Player loading... Please try again in a moment.');
            } else {
                // Fallback to demo mode for tracks without YouTube IDs
                if (!isPlaying) {
                    togglePlayPause();
                }
                currentTime = 0;
                updateProgressBar();
                showToast(`Demo mode: ${track.title} (Add YouTube ID to play actual audio)`);
            }
        }

        function playRecommendation(title) {
            // Play a random track for demo
            const randomTrack = sampleTracks[Math.floor(Math.random() * sampleTracks.length)];
            playTrack(randomTrack.id);
            showToast(`Playing ${title}`);
        }

        function togglePlayPause() {
            if (currentTrack && currentTrack.youtubeId && youtubePlayer && playerReady) {
                // YouTube player control
                if (isPlaying) {
                    youtubePlayer.pauseVideo();
                } else {
                    youtubePlayer.playVideo();
                }
            } else {
                // Demo mode fallback
                isPlaying = !isPlaying;
                updatePlayButton();
                
                if (isPlaying) {
                    startProgressTracking();
                } else {
                    stopProgressTracking();
                }
            }
        }

        function updateProgressBar() {
            if (isPlaying && currentTrack) {
                const progress = (currentTime / totalTime) * 100;
                document.getElementById('progress-fill').style.width = progress + '%';
                document.getElementById('current-time').textContent = formatTime(currentTime);
            }
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function seekTo(event) {
            const progressBar = event.currentTarget;
            const rect = progressBar.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const percentage = clickX / rect.width;
            
            if (currentTrack && currentTrack.youtubeId && youtubePlayer && playerReady) {
                // YouTube player seek
                const seekTime = percentage * youtubePlayer.getDuration();
                youtubePlayer.seekTo(seekTime, true);
            } else {
                // Demo mode seek
                currentTime = Math.floor(percentage * totalTime);
                updateProgressBar();
            }
        }

        // Search Functions
        function performSearch(query) {
            const searchResults = document.getElementById('search-results');
            const searchContent = document.getElementById('search-content');
            const browseSection = document.getElementById('browse-section');
            
            if (query.trim() === '') {
                searchResults.classList.add('hidden');
                browseSection.classList.remove('hidden');
                return;
            }
            
            searchResults.classList.remove('hidden');
            browseSection.classList.add('hidden');
            
            const results = sampleTracks.filter(track =>
                track.title.toLowerCase().includes(query.toLowerCase()) ||
                track.artist.toLowerCase().includes(query.toLowerCase()) ||
                track.album.toLowerCase().includes(query.toLowerCase()) ||
                track.genre.toLowerCase().includes(query.toLowerCase())
            );
            
            searchContent.innerHTML = '';
            
            if (results.length === 0) {
                searchContent.innerHTML = '<p style="color: #b3b3b3; text-align: center; padding: 32px;">No results found</p>';
                return;
            }
            
            results.forEach(track => {
                const item = document.createElement('div');
                item.className = 'card';
                item.style.marginBottom = '12px';
                item.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 16px;">
                        <div class="card-image" style="width: 48px; height: 48px; margin-bottom: 0; background: linear-gradient(135deg, #667eea, #764ba2);">
                            üéµ
                        </div>
                        <div style="flex: 1;">
                            <div class="card-title">${track.title}</div>
                            <div class="card-subtitle">${track.artist} ‚Ä¢ ${track.album}</div>
                        </div>
                        <div style="color: #b3b3b3; font-size: 14px;">${track.duration}</div>
                        <button onclick="playTrack('${track.id}')" class="btn btn-primary" style="padding: 8px 16px;">
                            Play
                        </button>
                    </div>
                `;
                searchContent.appendChild(item);
            });
        }

        // Modal Functions
        function openCreatePlaylistModal() {
            document.getElementById('playlist-modal').classList.remove('hidden');
        }

        function closeCreatePlaylistModal() {
            document.getElementById('playlist-modal').classList.add('hidden');
            document.getElementById('playlist-form').reset();
        }

        async function handleCreatePlaylist(event) {
            event.preventDefault();
            
            const name = document.getElementById('playlist-name').value.trim();
            const description = document.getElementById('playlist-description').value.trim();
            const privacy = document.getElementById('playlist-privacy').value;
            
            if (!name) return;
            
            await createPlaylist(name, description, privacy);
            closeCreatePlaylistModal();
        }
        
        // Usage Tracking Functions
        function startUsageTracking() {
            if (userProfile.isPremium) return; // Premium users have unlimited access
            
            // Reset daily usage if it's a new day
            const today = new Date().toDateString();
            if (userProfile.lastUsageReset !== today) {
                userProfile.dailyUsage = 0;
                userProfile.lastUsageReset = today;
                saveUserProfile();
            }
            
            // Check if user has exceeded daily limit
            if (userProfile.dailyUsage >= 240) { // 4 hours = 240 minutes
                showUsageLimitModal();
                return false;
            }
            
            usageStartTime = Date.now();
            usageInterval = setInterval(() => {
                if (usageStartTime) {
                    const currentUsage = Math.floor((Date.now() - usageStartTime) / 60000); // minutes
                    userProfile.dailyUsage += 1;
                    
                    updateUsageDisplay();
                    saveUserProfile();
                    
                    // Check if limit reached
                    if (userProfile.dailyUsage >= 240) {
                        showUsageLimitModal();
                        stopUsageTracking();
                    }
                }
            }, 60000); // Update every minute
            
            return true;
        }
        
        function stopUsageTracking() {
            if (usageInterval) {
                clearInterval(usageInterval);
                usageInterval = null;
            }
            usageStartTime = null;
        }
        
        function updateUsageDisplay() {
            const hours = Math.floor(userProfile.dailyUsage / 60);
            const minutes = userProfile.dailyUsage % 60;
            const usageText = `${hours}h ${minutes}m used today`;
            
            const usageElement = document.getElementById('usage-time');
            if (usageElement) {
                usageElement.textContent = usageText;
            }
            
            // Update account status
            const statusElement = document.getElementById('account-status');
            if (statusElement) {
                if (userProfile.isPremium) {
                    statusElement.textContent = 'Premium Plan - Unlimited access';
                } else {
                    const remaining = 240 - userProfile.dailyUsage;
                    const remainingHours = Math.floor(remaining / 60);
                    const remainingMinutes = remaining % 60;
                    statusElement.textContent = `Free Plan - ${remainingHours}h ${remainingMinutes}m remaining today`;
                }
            }
        }
        
        function showUsageLimitModal() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content" style="text-align: center;">
                    <h3 style="color: #ff4757; margin-bottom: 16px;">‚è∞ Daily Limit Reached</h3>
                    <p style="margin-bottom: 24px; color: #b3b3b3;">You've used your 4-hour daily limit. Upgrade to Premium for unlimited listening!</p>
                    <div style="display: flex; gap: 12px; justify-content: center;">
                        <button class="btn btn-primary" onclick="openUpgradeModal(); this.parentElement.parentElement.parentElement.remove();">
                            Upgrade to Premium
                        </button>
                        <button class="btn btn-secondary" onclick="this.parentElement.parentElement.parentElement.remove();">
                            Try Tomorrow
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Pause any playing music
            if (isPlaying) {
                togglePlayPause();
            }
        }
        
        // Profile Management
        function saveUserProfile() {
            try {
                localStorage.setItem('soundify_profile', JSON.stringify(userProfile));
            } catch (error) {
                console.error('Error saving profile:', error);
            }
        }
        
        function loadUserProfile() {
            try {
                const saved = localStorage.getItem('soundify_profile');
                if (saved) {
                    userProfile = { ...userProfile, ...JSON.parse(saved) };
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }
        
        // Modal Functions
        function openProfileModal() {
            document.getElementById('profile-name').value = userProfile.displayName;
            document.getElementById('profile-bio').value = userProfile.bio;
            document.getElementById('profile-genre').value = userProfile.favoriteGenre;
            updateUsageDisplay();
            document.getElementById('profile-modal').classList.remove('hidden');
        }
        
        function closeProfileModal() {
            document.getElementById('profile-modal').classList.add('hidden');
        }
        
        function openUpgradeModal() {
            // Show admin controls if user is admin
            const isAdmin = currentUser && adminEmails.includes(currentUser.email);
            const adminSection = document.getElementById('admin-upgrade-section');
            
            if (isAdmin) {
                adminSection.classList.remove('hidden');
            } else {
                adminSection.classList.add('hidden');
            }
            
            // Update button text based on premium status
            const upgradeBtn = document.getElementById('upgrade-action-btn');
            if (userProfile.isPremium) {
                upgradeBtn.textContent = 'Already Premium ‚úì';
                upgradeBtn.disabled = true;
                upgradeBtn.style.opacity = '0.6';
            } else {
                upgradeBtn.textContent = 'Upgrade Now';
                upgradeBtn.disabled = false;
                upgradeBtn.style.opacity = '1';
            }
            
            document.getElementById('upgrade-modal').classList.remove('hidden');
        }
        
        function closeUpgradeModal() {
            document.getElementById('upgrade-modal').classList.add('hidden');
        }
        
        // Premium Management (Admin Only)
        function grantPremium() {
            if (!currentUser || !adminEmails.includes(currentUser.email)) {
                showToast('‚ùå Access denied - Admin privileges required');
                return;
            }
            
            userProfile.isPremium = true;
            saveUserProfile();
            updateUsageDisplay();
            updateUpgradeButton();
            showToast('‚úÖ Premium access granted successfully!');
            addUpdateLogEntry('GRANTED', 'updated', 'üëë Admin granted Premium access to user');
        }
        
        function revokePremium() {
            if (!currentUser || !adminEmails.includes(currentUser.email)) {
                showToast('‚ùå Access denied - Admin privileges required');
                return;
            }
            
            userProfile.isPremium = false;
            saveUserProfile();
            updateUsageDisplay();
            updateUpgradeButton();
            showToast('‚ö†Ô∏è Premium access revoked');
            addUpdateLogEntry('REVOKED', 'updated', 'üëë Admin revoked Premium access from user');
        }
        
        function upgradeToPremium() {
            if (userProfile.isPremium) {
                showToast('‚úÖ You already have Premium access!');
                return;
            }
            
            // In a real app, this would integrate with payment processing
            showToast('üí≥ Payment processing not implemented in demo. Contact admin for Premium access.');
        }
        
        function updateUpgradeButton() {
            const upgradeText = document.getElementById('upgrade-text');
            if (userProfile.isPremium) {
                upgradeText.textContent = 'Premium ‚úì';
                upgradeText.parentElement.style.background = 'linear-gradient(135deg, #1db954, #1ed760)';
            } else {
                upgradeText.textContent = 'Upgrade';
                upgradeText.parentElement.style.background = 'white';
            }
        }
        
        // Profile Form Handler
        async function handleProfileUpdate(event) {
            event.preventDefault();
            
            userProfile.displayName = document.getElementById('profile-name').value.trim();
            userProfile.bio = document.getElementById('profile-bio').value.trim();
            userProfile.favoriteGenre = document.getElementById('profile-genre').value;
            
            saveUserProfile();
            closeProfileModal();
            showToast('‚úÖ Profile updated successfully!');
            addUpdateLogEntry('UPDATED', 'updated', 'üë§ User updated profile information');
        }

        // Utility Functions
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Configuration management (without Element SDK)
        function updateAppConfig() {
            const logoText = document.querySelector('#app-logo .logo-text');
            const authTitleText = document.querySelector('#auth-title span');
            
            if (logoText) logoText.textContent = defaultConfig.app_name;
            if (authTitleText) authTitleText.textContent = defaultConfig.app_name;
            document.getElementById('welcome-title').textContent = defaultConfig.welcome_message;
        }

        // Event Listeners
        document.getElementById('auth-form').addEventListener('submit', handleAuth);
        document.getElementById('auth-toggle-link').addEventListener('click', toggleAuthMode);
        document.getElementById('playlist-form').addEventListener('submit', handleCreatePlaylist);
        document.getElementById('profile-form').addEventListener('submit', handleProfileUpdate);

        // Progress update interval
        setInterval(() => {
            if (isPlaying && currentTrack) {
                currentTime += 1;
                if (currentTime >= totalTime) {
                    currentTime = 0;
                }
                updateProgressBar();
            }
        }, 1000);

        // Update Log Functions
        function toggleUpdateLog() {
            updateLogVisible = !updateLogVisible;
            const logPanel = document.getElementById('update-log');
            
            if (updateLogVisible) {
                logPanel.classList.add('show');
                renderUpdateLog();
            } else {
                logPanel.classList.remove('show');
            }
        }
        
        function renderUpdateLog() {
            const logEntries = document.getElementById('log-entries');
            logEntries.innerHTML = '';
            
            updateLog.forEach(entry => {
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${entry.type}`;
                logEntry.innerHTML = `
                    <div class="log-date">${entry.date}</div>
                    <div class="log-action">${entry.action}</div>
                    <div class="log-description">${entry.description}</div>
                `;
                logEntries.appendChild(logEntry);
            });
        }
        
        function addUpdateLogEntry(action, type, description) {
            const newEntry = {
                date: new Date().toLocaleDateString(),
                action: action,
                type: type,
                description: description
            };
            updateLog.unshift(newEntry);
            
            if (updateLogVisible) {
                renderUpdateLog();
            }
        }
        
        // Enhanced Player Functions
        function previousTrack() {
            if (currentTrackIndex > 0) {
                currentTrackIndex--;
                playTrack(sampleTracks[currentTrackIndex].id);
                showToast(`‚èÆÔ∏è Previous: ${sampleTracks[currentTrackIndex].title}`);
            } else {
                showToast('Already at first track');
            }
        }
        
        function nextTrack() {
            if (currentTrackIndex < sampleTracks.length - 1) {
                currentTrackIndex++;
                playTrack(sampleTracks[currentTrackIndex].id);
                showToast(`‚è≠Ô∏è Next: ${sampleTracks[currentTrackIndex].title}`);
            } else {
                showToast('Already at last track');
            }
        }
        
        function updateStats() {
            document.getElementById('total-tracks').textContent = sampleTracks.length;
            document.getElementById('total-playlists').textContent = playlists.length;
            document.getElementById('listening-time').textContent = Math.floor(listeningTime / 60) + 'h';
            
            // Calculate favorite genre
            const genreCounts = {};
            sampleTracks.forEach(track => {
                genreCounts[track.genre] = (genreCounts[track.genre] || 0) + 1;
            });
            const favoriteGenre = Object.keys(genreCounts).reduce((a, b) => 
                genreCounts[a] > genreCounts[b] ? a : b, 'Electronic');
            document.getElementById('favorite-genre').textContent = favoriteGenre;
        }
        
        // New Feature Functions
        function showYouTubeGuide() {
            showToast('üìñ YouTube Guide: Find a video ‚Üí Copy ID after "v=" ‚Üí Add to youtubeId field');
            addUpdateLogEntry('VIEWED', 'updated', 'üìñ User viewed YouTube integration guide');
        }
        
        function testYouTubeFeature() {
            if (sampleTracks.some(track => track.youtubeId)) {
                const trackWithYT = sampleTracks.find(track => track.youtubeId);
                playTrack(trackWithYT.id);
                showToast('üéß Testing YouTube integration with real audio!');
            } else {
                showToast('üéß Add YouTube IDs to tracks to test real audio playback');
            }
            addUpdateLogEntry('TESTED', 'updated', 'üéß User tested YouTube music integration');
        }
        
        function showAnalytics() {
            showToast('üìà Analytics: ' + sampleTracks.length + ' tracks, ' + playlists.length + ' playlists, ' + Math.floor(listeningTime / 60) + 'h listening time');
            addUpdateLogEntry('VIEWED', 'updated', 'üìà User viewed music analytics dashboard');
        }
        
        function exportData() {
            const data = {
                tracks: sampleTracks,
                playlists: playlists,
                stats: {
                    totalTracks: sampleTracks.length,
                    totalPlaylists: playlists.length,
                    listeningTime: listeningTime
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'soundify-data.json';
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('üíæ Data exported successfully!');
            addUpdateLogEntry('EXPORTED', 'updated', 'üíæ User exported music data and analytics');
        }
        
        function openThemeEditor() {
            showToast('üé® Theme Editor: Customization options coming soon!');
            addUpdateLogEntry('ACCESSED', 'updated', 'üé® User accessed theme customization options');
        }
        
        function resetTheme() {
            showToast('üîÑ Theme reset to default Soundify style');
            addUpdateLogEntry('RESET', 'updated', 'üîÑ User reset theme to default settings');
        }
        
        function openEqualizer() {
            const equalizer = document.getElementById('equalizer');
            if (equalizer.style.display === 'none') {
                equalizer.style.display = 'flex';
                showToast('üéõÔ∏è Equalizer enabled - Visual audio feedback active');
                addUpdateLogEntry('ENABLED', 'updated', 'üéõÔ∏è User enabled visual audio equalizer');
            } else {
                equalizer.style.display = 'none';
                showToast('üéõÔ∏è Equalizer disabled');
            }
        }
        
        function toggleBassBoost() {
            bassBoostEnabled = !bassBoostEnabled;
            if (bassBoostEnabled) {
                showToast('üîä Bass Boost ON - Enhanced low frequencies');
                addUpdateLogEntry('ENABLED', 'updated', 'üîä User enabled bass boost audio enhancement');
            } else {
                showToast('üîä Bass Boost OFF - Normal audio profile');
                addUpdateLogEntry('DISABLED', 'updated', 'üîä User disabled bass boost audio enhancement');
            }
        }
        
        // Enhanced playTrack function
        function playTrackEnhanced(trackId) {
            const track = sampleTracks.find(t => t.id === trackId);
            if (!track) return;
            
            currentTrackIndex = sampleTracks.findIndex(t => t.id === trackId);
            playTrack(trackId);
            
            // Show equalizer when playing
            if (isPlaying) {
                document.getElementById('equalizer').style.display = 'flex';
            }
            
            // Track listening time
            listeningTime += 1;
            updateStats();
        }
        
        // New Feature Functions
        function toggleVoiceControl() {
            voiceControlEnabled = !voiceControlEnabled;
            if (voiceControlEnabled) {
                showToast('üé§ Voice Control ON - Say "Play", "Pause", "Next", or "Previous"');
                addUpdateLogEntry('ENABLED', 'updated', 'üé§ User enabled voice control for music playback');
                startVoiceRecognition();
            } else {
                showToast('üé§ Voice Control OFF');
                addUpdateLogEntry('DISABLED', 'updated', 'üé§ User disabled voice control');
                stopVoiceRecognition();
            }
        }
        
        function testVoiceCommand() {
            showToast('üó£Ô∏è Say "Play" to test voice commands (Voice control must be enabled first)');
            addUpdateLogEntry('TESTED', 'updated', 'üó£Ô∏è User tested voice command functionality');
        }
        
        function startVoiceRecognition() {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.continuous = true;
                recognition.interimResults = false;
                recognition.lang = 'en-US';
                
                recognition.onresult = function(event) {
                    const command = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();
                    handleVoiceCommand(command);
                };
                
                recognition.start();
                window.voiceRecognition = recognition;
            } else {
                showToast('Voice recognition not supported in this browser');
            }
        }
        
        function stopVoiceRecognition() {
            if (window.voiceRecognition) {
                window.voiceRecognition.stop();
                window.voiceRecognition = null;
            }
        }
        
        function handleVoiceCommand(command) {
            if (command.includes('play')) {
                if (!isPlaying) togglePlayPause();
                showToast('üé§ Voice: Playing music');
            } else if (command.includes('pause') || command.includes('stop')) {
                if (isPlaying) togglePlayPause();
                showToast('üé§ Voice: Pausing music');
            } else if (command.includes('next')) {
                nextTrack();
                showToast('üé§ Voice: Next track');
            } else if (command.includes('previous') || command.includes('back')) {
                previousTrack();
                showToast('üé§ Voice: Previous track');
            }
        }
        
        function setSleepTimer(minutes) {
            if (sleepTimer) {
                clearTimeout(sleepTimer);
            }
            
            sleepTimer = setTimeout(() => {
                if (isPlaying) {
                    togglePlayPause();
                }
                showToast('üò¥ Sleep timer activated - Music paused');
                addUpdateLogEntry('ACTIVATED', 'updated', `üò¥ Sleep timer activated after ${minutes} minutes`);
            }, minutes * 60 * 1000);
            
            showToast(`‚è∞ Sleep timer set for ${minutes} minutes`);
            addUpdateLogEntry('SET', 'updated', `‚è∞ User set sleep timer for ${minutes} minutes`);
        }
        
        function generateRecommendations() {
            const moods = ['energetic', 'chill', 'focus', 'party', 'romantic'];
            const randomMood = moods[Math.floor(Math.random() * moods.length)];
            showToast(`ü§ñ AI Recommendations: Found 12 ${randomMood} tracks based on your listening history`);
            addUpdateLogEntry('GENERATED', 'updated', `ü§ñ AI generated ${randomMood} music recommendations`);
        }
        
        function setMoodFilter(mood) {
            currentMoodFilter = mood;
            showToast(`üéØ Mood Filter: ${mood} mode activated`);
            addUpdateLogEntry('ACTIVATED', 'updated', `üéØ User activated ${mood} mood filter`);
        }
        
        function toggleVisualizer() {
            visualizerEnabled = !visualizerEnabled;
            if (visualizerEnabled) {
                showToast('üåà Visualizer ON - Beautiful audio animations enabled');
                addUpdateLogEntry('ENABLED', 'updated', 'üåà User enabled audio visualizer');
            } else {
                showToast('üåà Visualizer OFF');
                addUpdateLogEntry('DISABLED', 'updated', 'üåà User disabled audio visualizer');
            }
        }
        
        function changeVisualizerTheme() {
            const themes = ['Neon', 'Ocean', 'Fire', 'Galaxy', 'Minimal'];
            const randomTheme = themes[Math.floor(Math.random() * themes.length)];
            showToast(`üé≠ Visualizer Theme: ${randomTheme} theme activated`);
            addUpdateLogEntry('CHANGED', 'updated', `üé≠ User changed visualizer theme to ${randomTheme}`);
        }
        
        function shareCurrentTrack() {
            if (currentTrack) {
                showToast(`üì§ Shared: "${currentTrack.title}" by ${currentTrack.artist}`);
                addUpdateLogEntry('SHARED', 'updated', `üì§ User shared track: ${currentTrack.title}`);
            } else {
                showToast('üì§ No track currently playing to share');
            }
        }
        
        function viewFriendsActivity() {
            const activities = [
                'Alex is listening to "Midnight Dreams"',
                'Sarah added 5 songs to "Workout Mix"',
                'Mike is currently online',
                'Emma shared "Neon Lights" playlist'
            ];
            const randomActivity = activities[Math.floor(Math.random() * activities.length)];
            showToast(`üë• Friends: ${randomActivity}`);
            addUpdateLogEntry('VIEWED', 'updated', 'üë• User viewed friends activity feed');
        }
        
        function createCollaborativePlaylist() {
            showToast('ü§ù Collaborative playlist "Friends Mix" created - Invite friends to add songs!');
            addUpdateLogEntry('CREATED', 'updated', 'ü§ù User created collaborative playlist');
        }
        
        function updateOnlineCount() {
            const min = 3;
            const max = 78;
            const count = Math.floor(Math.random() * (max - min + 1)) + min;
            document.getElementById('online-count').textContent = count;
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', async () => {
            // Initialize configuration
            updateAppConfig();
            loadYouTubeAPI();
            loadUserProfile();
            updateStats();
            
            // Update online count every 30 seconds
            updateOnlineCount();
            setInterval(updateOnlineCount, 30000);
            
            // Add Google sign-in event listener
            document.getElementById('google-signin-btn').addEventListener('click', signInWithGoogle);
            
            // Auto-show update log on first visit with slide animation
            setTimeout(() => {
                if (!updateLogVisible) {
                    toggleUpdateLog();
                    document.getElementById('update-log').classList.add('slide-up');
                    setTimeout(() => toggleUpdateLog(), 5000); // Auto-close after 5 seconds
                }
            }, 2000);
            
            // Add performance monitoring
            if ('performance' in window) {
                window.addEventListener('load', () => {
                    const loadTime = performance.now();
                    if (loadTime > 3000) {
                        console.warn('Slow page load detected:', loadTime + 'ms');
                    }
                });
            }
            
            // Show welcome message
            const welcomeMsg = userProfile.isPremium ? 
                'üéµ Welcome to Soundify Premium! Unlimited music awaits.' : 
                'üéµ Welcome to Soundify! 4 hours of daily music streaming.';
            showToast(welcomeMsg);
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99443684447dbd9b',t:'MTc2MTQyMTUxMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
