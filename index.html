<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soundify - Your Music, Your Vibe</title>
    <link rel="icon" href="favicon.ico">
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #191414;
            color: white;
            height: 100%;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        /* Watermark */
        .watermark {
            position: fixed;
            bottom: 10px;
            left: 10px;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.3);
            z-index: 1000;
            pointer-events: none;
            font-weight: 500;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background-color: #121212;
            padding: 24px;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #282828;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #1DB954;
            margin-bottom: 32px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-menu {
            list-style: none;
            margin-bottom: 32px;
        }

        .nav-item {
            margin-bottom: 16px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #b3b3b3;
            text-decoration: none;
            font-weight: 500;
            padding: 8px 0;
            transition: color 0.2s;
        }

        .nav-link:hover, .nav-link.active {
            color: white;
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .create-section {
            margin-bottom: 32px;
            padding-top: 16px;
            border-top: 1px solid #282828;
        }

        .create-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #b3b3b3;
            background: none;
            border: none;
            font-size: 14px;
            cursor: pointer;
            padding: 8px 0;
            transition: color 0.2s;
            width: 100%;
            text-align: left;
        }

        .create-btn:hover {
            color: white;
        }

        .online-section {
            margin-bottom: 16px;
            padding-top: 16px;
            border-top: 1px solid #282828;
        }

        .section-title {
            font-size: 12px;
            color: #b3b3b3;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .online-users {
            margin-bottom: 24px;
        }

        .online-count {
            font-size: 12px;
            color: #1DB954;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .recent-playlists {
            flex: 1;
            overflow-y: auto;
        }

        .recent-playlist {
            font-size: 14px;
            color: #b3b3b3;
            margin-bottom: 8px;
            cursor: pointer;
            transition: color 0.2s;
        }

        .recent-playlist:hover {
            color: white;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: linear-gradient(180deg, #1e3264 0%, #191414 300px);
        }

        .top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 32px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
        }

        .nav-buttons {
            display: flex;
            gap: 16px;
        }

        .nav-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .nav-btn:hover {
            background: rgba(0, 0, 0, 0.9);
        }

        .top-bar-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            width: 350px;
            padding: 12px 16px 12px 48px;
            border-radius: 25px;
            border: none;
            background: white;
            color: black;
            font-size: 14px;
            outline: none;
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            fill: #666;
        }

        .time-remaining {
            font-size: 12px;
            color: #b3b3b3;
        }

        .premium-badge {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: black;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .auth-buttons {
            display: flex;
            gap: 12px;
        }

        .btn-primary {
            background: #1DB954;
            color: black;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-primary:hover {
            background: #1ed760;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .profile-pic {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #535353;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .profile-pic:hover {
            background: #727272;
        }

        .sign-out-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: color 0.2s;
        }

        .sign-out-btn:hover {
            color: white;
        }

        /* Content Area Styles */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-header {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 24px;
        }

        .quick-access {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 48px;
        }

        .quick-item {
            background: linear-gradient(135deg, #8b5cf6, #3b82f6);
            border-radius: 8px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .quick-item:hover {
            transform: scale(1.02);
        }

        .quick-item:nth-child(2) {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .quick-item:nth-child(3) {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .quick-icon {
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 24px;
            margin-bottom: 48px;
        }

        .card {
            background: #181818;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
            position: relative;
            group: hover;
        }

        .card:hover {
            background: #282828;
            transform: translateY(-4px);
        }

        .card-image {
            width: 100%;
            aspect-ratio: 1;
            background: #535353;
            border-radius: 8px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .card-image svg {
            width: 48px;
            height: 48px;
            fill: white;
        }

        .play-btn {
            position: absolute;
            bottom: 8px;
            right: 8px;
            width: 48px;
            height: 48px;
            background: #1DB954;
            border: none;
            border-radius: 50%;
            color: black;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: translateY(8px);
            transition: all 0.2s;
        }

        .card:hover .play-btn {
            opacity: 1;
            transform: translateY(0);
        }

        .play-btn:hover {
            transform: scale(1.05);
        }

        .card-title {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .card-subtitle {
            color: #b3b3b3;
            font-size: 14px;
        }

        /* Language Filter */
        .language-filter {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .language-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #b3b3b3;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .language-btn:hover, .language-btn.active {
            background: #1DB954;
            color: black;
        }

        /* Search Styles */
        .genre-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
            margin-bottom: 48px;
        }

        .genre-card {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border-radius: 8px;
            padding: 24px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s;
            min-height: 120px;
            display: flex;
            align-items: flex-end;
        }

        .genre-card:hover {
            transform: scale(1.02);
        }

        .genre-card:nth-child(2) {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .genre-card:nth-child(3) {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }

        .genre-card:nth-child(4) {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        .genre-title {
            font-size: 24px;
            font-weight: bold;
            z-index: 2;
        }

        .genre-decoration {
            position: absolute;
            top: -20px;
            right: -20px;
            width: 80px;
            height: 80px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 50%;
        }

        .search-results {
            display: none;
        }

        .search-results.active {
            display: block;
        }

        .track-list {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        .track-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .track-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .track-item:last-child {
            border-bottom: none;
        }

        .track-number {
            width: 40px;
            color: #b3b3b3;
            font-size: 14px;
        }

        .track-image {
            width: 48px;
            height: 48px;
            background: #535353;
            border-radius: 4px;
            margin-right: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .track-info {
            flex: 1;
        }

        .track-title {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .track-artist {
            color: #b3b3b3;
            font-size: 14px;
        }

        .track-album {
            color: #b3b3b3;
            font-size: 14px;
            width: 200px;
        }

        .track-duration {
            color: #b3b3b3;
            font-size: 14px;
            width: 60px;
            text-align: right;
        }

        .track-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: color 0.2s;
        }

        .action-btn:hover {
            color: white;
        }

        /* Player Bar Styles */
        .player-bar {
            background: #181818;
            border-top: 1px solid #282828;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .player-left {
            display: flex;
            align-items: center;
            gap: 16px;
            width: 30%;
        }

        .current-track-image {
            width: 56px;
            height: 56px;
            background: #535353;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .current-track-info {
            flex: 1;
        }

        .current-track-title {
            font-weight: 500;
            margin-bottom: 4px;
            font-size: 14px;
        }

        .current-track-artist {
            color: #b3b3b3;
            font-size: 12px;
        }

        .like-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            cursor: pointer;
            padding: 8px;
            transition: color 0.2s;
        }

        .like-btn:hover, .like-btn.liked {
            color: #1DB954;
        }

        .player-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 40%;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 12px;
        }

        .control-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            cursor: pointer;
            padding: 8px;
            transition: color 0.2s;
        }

        .control-btn:hover, .control-btn.active {
            color: white;
        }

        .play-pause-btn {
            width: 40px;
            height: 40px;
            background: white;
            border: none;
            border-radius: 50%;
            color: black;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .play-pause-btn:hover {
            transform: scale(1.05);
        }

        .progress-container {
            display: flex;
            align-items: center;
            gap: 12px;
            width: 100%;
        }

        .time-display {
            font-size: 12px;
            color: #b3b3b3;
            min-width: 40px;
        }

        .progress-bar {
            flex: 1;
            height: 4px;
            background: #535353;
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: white;
            border-radius: 2px;
            transition: width 0.1s;
        }

        .progress-bar:hover .progress-fill {
            background: #1DB954;
        }

        .player-right {
            display: flex;
            align-items: center;
            gap: 16px;
            width: 30%;
            justify-content: flex-end;
        }

        .volume-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .volume-bar {
            width: 80px;
            height: 4px;
            background: #535353;
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }

        .volume-fill {
            height: 100%;
            background: white;
            border-radius: 2px;
        }

        /* Autoplay Toggle */
        .autoplay-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #b3b3b3;
        }

        .toggle-switch {
            width: 40px;
            height: 20px;
            background: #535353;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .toggle-switch.active {
            background: #1DB954;
        }

        .toggle-slider {
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.2s;
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(20px);
        }

        /* Voice Control Styles */
        .voice-control {
            position: fixed;
            bottom: 100px;
            right: 30px;
            z-index: 1000;
        }

        .voice-btn {
            width: 60px;
            height: 60px;
            background: #1DB954;
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(29, 185, 84, 0.3);
            transition: all 0.2s;
        }

        .voice-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 25px rgba(29, 185, 84, 0.4);
        }

        .voice-btn.listening {
            background: #ef4444;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .voice-feedback {
            position: absolute;
            bottom: 70px;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            white-space: nowrap;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.2s;
        }

        .voice-feedback.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: #282828;
            border-radius: 8px;
            padding: 32px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 4px;
            background: #535353;
            color: white;
            font-size: 14px;
            outline: none;
        }

        .form-input:focus {
            background: #727272;
        }

        .form-textarea {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 4px;
            background: #535353;
            color: white;
            font-size: 14px;
            outline: none;
            resize: vertical;
            min-height: 80px;
        }

        .form-textarea:focus {
            background: #727272;
        }

        .form-select {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 4px;
            background: #535353;
            color: white;
            font-size: 14px;
            outline: none;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 24px;
        }

        .btn-secondary {
            background: none;
            border: 1px solid #535353;
            color: #b3b3b3;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-secondary:hover {
            color: white;
            border-color: white;
        }

        .admin-section {
            margin-bottom: 24px;
        }

        .premium-users-list {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            padding: 8px;
        }

        .premium-user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin-bottom: 8px;
        }

        .premium-user-item:last-child {
            margin-bottom: 0;
        }

        .revoke-btn {
            background: #ef4444;
            border: none;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .revoke-btn:hover {
            background: #dc2626;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                width: 240px;
            }

            .search-input {
                width: 250px;
            }

            .content-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .genre-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .quick-access {
                grid-template-columns: 1fr;
            }
        }

        .hidden {
            display: none !important;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body>
    <div class="watermark">Made by Vesni & Forca Team</div>
    
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                🎵 Soundify
            </div>
            
            <nav>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" onclick="showSection('home')">
                            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                            Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('search')">
                            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                            Search
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('library')">
                            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"/></svg>
                            Your Library
                        </a>
                    </li>
                </ul>
            </nav>
            
            <div class="create-section">
                <button class="create-btn" onclick="createPlaylist()">
                    <svg class="nav-icon" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                    Create Playlist
                </button>
                <button class="create-btn" onclick="showLikedSongs()">
                    <svg class="nav-icon" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                    Liked Songs
                </button>
            </div>
            
            <div class="online-section">
                <div class="section-title">Online Users</div>
                <div class="online-users" id="onlineUsers">
                    <div class="online-count" id="onlineCount">🟢 1,247 users online</div>
                </div>
                
                <div class="section-title">Recently Played</div>
                <div class="recent-playlists" id="recentPlaylists">
                    <div class="recent-playlist">🎵 My Playlist #1</div>
                    <div class="recent-playlist">🎶 Chill Vibes</div>
                    <div class="recent-playlist">💪 Workout Mix</div>
                    <div class="recent-playlist">🚗 Road Trip Songs</div>
                    <div class="recent-playlist">📚 Study Focus</div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar">
                <div class="nav-buttons">
                    <button class="nav-btn" onclick="goBack()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
                    </button>
                    <button class="nav-btn" onclick="goForward()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
                    </button>
                </div>
                
                <div class="top-bar-right">
                    <div class="search-box">
                        <input type="text" class="search-input" placeholder="Search for songs, artists, or playlists" id="searchInput" onkeyup="handleSearch(event)">
                        <svg class="search-icon" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    </div>
                    
                    <div id="timeRemaining" class="time-remaining hidden">
                        Time left: <span id="timeLeft">4:00:00</span>
                    </div>
                    
                    <div id="premiumBadge" class="premium-badge hidden">
                        PREMIUM
                    </div>
                    
                    <div id="authButtons" class="auth-buttons">
                        <button class="btn-primary" onclick="signInWithGoogle()">
                            Sign In
                        </button>
                    </div>
                    
                    <div id="userProfile" class="user-profile hidden">
                        <button class="btn-primary" onclick="togglePremium()" id="upgradeBtn">
                            Upgrade
                        </button>
                        <div class="profile-pic" onclick="showProfile()" id="profilePic">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                        </div>
                        <button class="sign-out-btn" onclick="signOut()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/></svg>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area scrollbar-hide">
                <!-- Home Section -->
                <section id="homeSection" class="section active">
                    <h1 class="section-header">Good evening</h1>
                    
                    <div class="quick-access">
                        <div class="quick-item" onclick="playPlaylist('liked')">
                            <div class="quick-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                            </div>
                            <span>Liked Songs</span>
                        </div>
                        <div class="quick-item" onclick="playPlaylist('discover')">
                            <div class="quick-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                            </div>
                            <span>Discover Weekly</span>
                        </div>
                        <div class="quick-item" onclick="playPlaylist('mix')">
                            <div class="quick-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                            </div>
                            <span>Your Mix</span>
                        </div>
                    </div>

                    <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 24px;">Recently played</h2>
                    <div class="content-grid" id="recentlyPlayed">
                        <!-- Recently played items will be populated by JavaScript -->
                    </div>

                    <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 24px;">Made for you</h2>
                    <div class="content-grid" id="madeForYou">
                        <!-- Made for you items will be populated by JavaScript -->
                    </div>

                    <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 24px;">Popular playlists</h2>
                    <div class="content-grid" id="popularPlaylists">
                        <!-- Popular playlists will be populated by JavaScript -->
                    </div>
                </section>

                <!-- Search Section -->
                <section id="searchSection" class="section">
                    <h1 class="section-header">Search</h1>
                    
                    <div class="language-filter" id="languageFilter">
                        <button class="language-btn active" onclick="filterByLanguage('all')">All Languages</button>
                        <button class="language-btn" onclick="filterByLanguage('en')">English</button>
                        <button class="language-btn" onclick="filterByLanguage('es')">Spanish</button>
                        <button class="language-btn" onclick="filterByLanguage('fr')">French</button>
                        <button class="language-btn" onclick="filterByLanguage('de')">German</button>
                        <button class="language-btn" onclick="filterByLanguage('it')">Italian</button>
                        <button class="language-btn" onclick="filterByLanguage('pt')">Portuguese</button>
                        <button class="language-btn" onclick="filterByLanguage('ja')">Japanese</button>
                        <button class="language-btn" onclick="filterByLanguage('ko')">Korean</button>
                        <button class="language-btn" onclick="filterByLanguage('hi')">Hindi</button>
                        <button class="language-btn" onclick="filterByLanguage('ar')">Arabic</button>
                        <button class="language-btn" onclick="filterByLanguage('ru')">Russian</button>
                    </div>
                    
                    <div class="genre-grid">
                        <div class="genre-card" onclick="searchByGenre('pop')">
                            <h3 class="genre-title">Pop</h3>
                            <div class="genre-decoration"></div>
                        </div>
                        <div class="genre-card" onclick="searchByGenre('hip-hop')">
                            <h3 class="genre-title">Hip-Hop</h3>
                            <div class="genre-decoration"></div>
                        </div>
                        <div class="genre-card" onclick="searchByGenre('rock')">
                            <h3 class="genre-title">Rock</h3>
                            <div class="genre-decoration"></div>
                        </div>
                        <div class="genre-card" onclick="searchByGenre('electronic')">
                            <h3 class="genre-title">Electronic</h3>
                            <div class="genre-decoration"></div>
                        </div>
                    </div>
                    
                    <div id="searchResults" class="search-results">
                        <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 24px;">Search Results</h2>
                        <div class="track-list" id="searchResultsList">
                            <!-- Search results will be populated by JavaScript -->
                        </div>
                    </div>
                </section>

                <!-- Library Section -->
                <section id="librarySection" class="section">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 32px;">
                        <h1 class="section-header" style="margin-bottom: 0;">Your Library</h1>
                        <button class="btn-primary" onclick="createPlaylist()">
                            Create Playlist
                        </button>
                    </div>
                    
                    <div style="display: flex; gap: 16px; margin-bottom: 32px;">
                        <button class="btn-primary" onclick="filterLibrary('all')" style="font-size: 14px; padding: 8px 16px;">All</button>
                        <button class="btn-secondary" onclick="filterLibrary('playlists')" style="font-size: 14px; padding: 8px 16px;">Playlists</button>
                        <button class="btn-secondary" onclick="filterLibrary('artists')" style="font-size: 14px; padding: 8px 16px;">Artists</button>
                        <button class="btn-secondary" onclick="filterLibrary('albums')" style="font-size: 14px; padding: 8px 16px;">Albums</button>
                    </div>
                    
                    <div id="libraryContent">
                        <!-- Library content will be populated by JavaScript -->
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Player Bar -->
    <footer class="player-bar">
        <div class="player-left">
            <div class="current-track-image" id="currentTrackImage">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="white"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
            </div>
            <div class="current-track-info">
                <div class="current-track-title" id="currentTrackTitle">Choose a song</div>
                <div class="current-track-artist" id="currentTrackArtist">Select music to play</div>
            </div>
            <button class="like-btn" onclick="toggleLike()" id="likeButton">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
            </button>
        </div>

        <div class="player-center">
            <div class="player-controls">
                <button class="control-btn" onclick="toggleShuffle()" id="shuffleButton">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/></svg>
                </button>
                <button class="control-btn" onclick="previousTrack()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg>
                </button>
                <button class="play-pause-btn" onclick="togglePlay()" id="playButton">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" id="playIcon"><path d="M8 5v14l11-7z"/></svg>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" id="pauseIcon" class="hidden"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <button class="control-btn" onclick="nextTrack()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg>
                </button>
                <button class="control-btn" onclick="toggleRepeat()" id="repeatButton">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"/></svg>
                </button>
            </div>
            <div class="progress-container">
                <span class="time-display" id="currentTime">0:00</span>
                <div class="progress-bar" onclick="seekTo(event)" id="progressBar">
                    <div class="progress-fill" id="progress"></div>
                </div>
                <span class="time-display" id="duration">0:00</span>
            </div>
        </div>

        <div class="player-right">
            <div class="autoplay-toggle">
                <span>Autoplay</span>
                <div class="toggle-switch active" onclick="toggleAutoplay()" id="autoplayToggle">
                    <div class="toggle-slider"></div>
                </div>
            </div>
            <button class="control-btn" onclick="toggleQueue()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/></svg>
            </button>
            <button class="control-btn" onclick="toggleDevices()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M21 3H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm0-4v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11z"/></svg>
            </button>
            <div class="volume-container">
                <button class="control-btn" onclick="toggleMute()" id="volumeButton">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" id="volumeIcon"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                </button>
                <div class="volume-bar" onclick="setVolume(event)" id="volumeBar">
                    <div class="volume-fill" id="volumeLevel" style="width: 70%;"></div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Voice Control -->
    <div class="voice-control">
        <div class="voice-feedback" id="voiceFeedback"></div>
        <button class="voice-btn" onclick="toggleVoiceControl()" id="voiceBtn">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/></svg>
        </button>
    </div>

    <!-- YouTube Player (Hidden) -->
    <div id="youtubePlayer" style="display: none;"></div>

    <script>
        // Extended multilingual music data with 400+ songs
        const musicData = {
            tracks: [
                // English Pop Hits
                { id: 1, title: "Anti-Hero", artist: "Taylor Swift", album: "Midnights", duration: "3:20", youtubeId: "b1kbLWvqugk", genre: "pop", language: "en" },
                { id: 2, title: "As It Was", artist: "Harry Styles", album: "Harry's House", duration: "2:47", youtubeId: "H5v3kku4y6Q", genre: "pop", language: "en" },
                { id: 3, title: "Flowers", artist: "Miley Cyrus", album: "Endless Summer Vacation", duration: "3:20", youtubeId: "G7KNmW9a75Y", genre: "pop", language: "en" },
                { id: 4, title: "Unholy", artist: "Sam Smith ft. Kim Petras", album: "Gloria", duration: "2:36", youtubeId: "Uq9gPaIzbe8", genre: "pop", language: "en" },
                { id: 5, title: "Vampire", artist: "Olivia Rodrigo", album: "GUTS", duration: "3:39", youtubeId: "RlPNh_PBZb4", genre: "pop", language: "en" },
                { id: 6, title: "Calm Down", artist: "Rema & Selena Gomez", album: "Rave & Roses", duration: "3:59", youtubeId: "WcIcVapfqXw", genre: "pop", language: "en" },
                { id: 7, title: "Shivers", artist: "Ed Sheeran", album: "=", duration: "3:27", youtubeId: "Il0S8BoucSA", genre: "pop", language: "en" },
                { id: 8, title: "Stay", artist: "The Kid LAROI & Justin Bieber", album: "F*CK LOVE 3", duration: "2:21", youtubeId: "kTJczUoc26U", genre: "pop", language: "en" },
                { id: 9, title: "Levitating", artist: "Dua Lipa", album: "Future Nostalgia", duration: "3:23", youtubeId: "TUVcZfQe-Kw", genre: "pop", language: "en" },
                { id: 10, title: "Blinding Lights", artist: "The Weeknd", album: "After Hours", duration: "3:20", youtubeId: "4NRXx6U8ABQ", genre: "pop", language: "en" },
{ id: 101, title: "Treat You Better", artist: "Shawn Mendes Sheeran", album: "=", duration: "4:16", youtubeId: "lY2yjAdbvdQ", genre: "pop", language: "en" },             
    { id: 105, title: "Shape of You", artist: "Ed Sheeran", album: "÷ (Divide)", duration: "3:53", youtubeId: "JGwWNGJdvx8", genre: "pop", language: "en" },
    { id: 106, title: "Happier Than Ever", artist: "Billie Eilish", album: "Happier Than Ever", duration: "4:58", youtubeId: "5GJWxDKyk3A", genre: "alternative", language: "en" },
    { id: 107, title: "Industry Baby", artist: "Lil Nas X & Jack Harlow", album: "Montero", duration: "3:32", youtubeId: "UTHLKHL_whs", genre: "rap", language: "en" },
    { id: 108, title: "Watermelon Sugar", artist: "Harry Styles", album: "Fine Line", duration: "2:54", youtubeId: "E07s5ZYygMg", genre: "pop", language: "en" },
    { id: 109, title: "Don't Start Now", artist: "Dua Lipa", album: "Future Nostalgia", duration: "3:03", youtubeId: "oygrmJFKYZY", genre: "pop", language: "en" },
    { id: 110, title: "Sunflower", artist: "Post Malone & Swae Lee", album: "Spider-Man: Into the Spider-Verse", duration: "2:38", youtubeId: "ApXoWvfEYVU", genre: "hip-hop", language: "en" },
    { id: 111, title: "Bad Guy", artist: "Billie Eilish", album: "When We All Fall Asleep, Where Do We Go?", duration: "3:14", youtubeId: "DyDfgMOUjCI", genre: "alternative", language: "en" },
    { id: 112, title: "Uptown Funk", artist: "Mark Ronson ft. Bruno Mars", album: "Uptown Special", duration: "4:31", youtubeId: "OPf0YbXqDm0", genre: "funk", language: "en" },
    { id: 113, title: "Closer", artist: "The Chainsmokers ft. Halsey", album: "Collage", duration: "4:05", youtubeId: "PT2_F-1esPk", genre: "electronic", language: "en" },
    { id: 114, title: "Believer", artist: "Imagine Dragons", album: "Evolve", duration: "3:24", youtubeId: "7wtfhZwyrcc", genre: "rock", language: "en" },
    { id: 115, title: "Circles", artist: "Post Malone", album: "Hollywood's Bleeding", duration: "3:35", youtubeId: "wXhTHyIgQ_U", genre: "pop", language: "en" },
    { id: 116, title: "Peaches", artist: "Justin Bieber ft. Daniel Caesar, Giveon", album: "Justice", duration: "3:18", youtubeId: "tQ0yjYUFKAE", genre: "r&b", language: "en" },
    { id: 117, title: "Save Your Tears", artist: "The Weeknd", album: "After Hours", duration: "3:35", youtubeId: "XXYlFuWEuKI", genre: "synth-pop", language: "en" },
    { id: 118, title: "As It Was", artist: "Harry Styles", album: "Harry’s House", duration: "2:47", youtubeId: "H5v3kku4y6Q", genre: "pop", language: "en" },
    { id: 119, title: "Someone You Loved", artist: "Lewis Capaldi", album: "Divinely Uninspired to a Hellish Extent", duration: "3:02", youtubeId: "zABLecsR5UE", genre: "ballad", language: "en" },
    { id: 120, title: "Take Me To Church", artist: "Hozier", album: "Hozier", duration: "4:01", youtubeId: "PVjiKRfKpPI", genre: "soul", language: "en" },
    { id: 121, title: "Rockstar", artist: "DaBaby ft. Roddy Ricch", album: "Blame It on Baby", duration: "3:01", youtubeId: "mxFstYSbBmc", genre: "rap", language: "en" },
    { id: 122, title: "Heat Waves", artist: "Glass Animals", album: "Dreamland", duration: "3:58", youtubeId: "mRD0-GxqHVo", genre: "indie", language: "en" },
    { id: 123, title: "Stressed Out", artist: "Twenty One Pilots", album: "Blurryface", duration: "3:22", youtubeId: "pXRviuL6vMY", genre: "alternative", language: "en" },
    { id: 124, title: "Viva La Vida", artist: "Coldplay", album: "Viva La Vida or Death and All His Friends", duration: "4:03", youtubeId: "dvgZkm1xWPE", genre: "rock", language: "en" },
    { id: 125, title: "Counting Stars", artist: "OneRepublic", album: "Native", duration: "4:17", youtubeId: "hT_nvWreIhg", genre: "pop-rock", language: "en" }
                // Spanish Songs
                { id: 11, title: "Despacito", artist: "Luis Fonsi ft. Daddy Yankee", album: "Vida", duration: "3:47", youtubeId: "kJQP7kiw5Fk", genre: "pop", language: "es" },
                { id: 12, title: "La Tortura", artist: "Shakira ft. Alejandro Sanz", album: "Fijación Oral", duration: "3:33", youtubeId: "Dsp_8Lm1eSk", genre: "pop", language: "es" },
                { id: 13, title: "Hips Don't Lie", artist: "Shakira ft. Wyclef Jean", album: "Oral Fixation", duration: "3:38", youtubeId: "DUT5rEU6pqM", genre: "pop", language: "es" },
                { id: 14, title: "Gasolina", artist: "Daddy Yankee", album: "Barrio Fino", duration: "3:12", youtubeId: "qGKrc3A6HHM", genre: "reggaeton", language: "es" },
                { id: 15, title: "Con Altura", artist: "Rosalía & J Balvin", album: "El Mal Querer", duration: "2:58", youtubeId: "p7bfOZek9t4", genre: "pop", language: "es" },

                // French Songs
                { id: 16, title: "La Vie En Rose", artist: "Édith Piaf", album: "Chansons parisiennes", duration: "3:05", youtubeId: "kFzViYkZAz4", genre: "chanson", language: "fr" },
                { id: 17, title: "Alors on Danse", artist: "Stromae", album: "Cheese", duration: "3:28", youtubeId: "VHoT4N43jK8", genre: "electronic", language: "fr" },
                { id: 18, title: "Papaoutai", artist: "Stromae", album: "Racine Carrée", duration: "3:52", youtubeId: "oiKj0Z_Xnjc", genre: "electronic", language: "fr" },
                { id: 19, title: "Dernière Danse", artist: "Indila", album: "Mini World", duration: "3:35", youtubeId: "K5KAc5CoCuk", genre: "pop", language: "fr" },
                { id: 20, title: "Je Veux", artist: "Zaz", album: "Zaz", duration: "3:30", youtubeId: "Tm88QAI8I5A", genre: "chanson", language: "fr" },

                // German Songs
                { id: 21, title: "99 Luftballons", artist: "Nena", album: "Nena", duration: "3:52", youtubeId: "La4Dcd1aUcE", genre: "pop", language: "de" },
                { id: 22, title: "Du Hast", artist: "Rammstein", album: "Sehnsucht", duration: "3:54", youtubeId: "W3q8Od5qJio", genre: "metal", language: "de" },
                { id: 23, title: "Sonne", artist: "Rammstein", album: "Mutter", duration: "4:32", youtubeId: "StZcUAPRRac", genre: "metal", language: "de" },
                { id: 24, title: "Atemlos durch die Nacht", artist: "Helene Fischer", album: "Farbenspiel", duration: "3:43", youtubeId: "haECT-SerHk", genre: "pop", language: "de" },
                { id: 25, title: "Major Tom", artist: "Peter Schilling", album: "Error in the System", duration: "4:58", youtubeId: "wO0A0XcWy88", genre: "pop", language: "de" },

                // Italian Songs
                { id: 26, title: "Volare", artist: "Domenico Modugno", album: "Nel blu dipinto di blu", duration: "3:28", youtubeId: "P7Y2lGYva-o", genre: "pop", language: "it" },
                { id: 27, title: "Con te partirò", artist: "Andrea Bocelli", album: "Bocelli", duration: "4:10", youtubeId: "Wdx5nGphnAI", genre: "opera", language: "it" },
                { id: 28, title: "Caruso", artist: "Lucio Dalla", album: "DallAmeriCaruso", duration: "4:39", youtubeId: "sOGAjBdJgpE", genre: "pop", language: "it" },
                { id: 29, title: "Gloria", artist: "Umberto Tozzi", album: "Tu", duration: "4:12", youtubeId: "355Fk8drgZE", genre: "pop", language: "it" },
                { id: 30, title: "L'Italiano", artist: "Toto Cutugno", album: "L'Italiano", duration: "4:10", youtubeId: "MSaJEWRSLzM", genre: "pop", language: "it" },

                // Portuguese Songs
                { id: 31, title: "The Girl from Ipanema", artist: "Stan Getz & Astrud Gilberto", album: "Getz/Gilberto", duration: "5:20", youtubeId: "UJkxFhFRFDA", genre: "bossa nova", language: "pt" },
                { id: 32, title: "Mas Que Nada", artist: "Jorge Ben Jor", album: "Samba Esquema Novo", duration: "2:35", youtubeId: "pLHy5P8vCpE", genre: "samba", language: "pt" },
                { id: 33, title: "Águas de Março", artist: "Elis Regina & Tom Jobim", album: "Elis & Tom", duration: "3:15", youtubeId: "xRqI5R6L7ow", genre: "bossa nova", language: "pt" },
                { id: 34, title: "Corcovado", artist: "Antonio Carlos Jobim", album: "The Composer of Desafinado", duration: "2:33", youtubeId: "5B6GCDhJm2Y", genre: "bossa nova", language: "pt" },
                { id: 35, title: "Desafinado", artist: "João Gilberto", album: "Chega de Saudade", duration: "3:05", youtubeId: "7-9wXQpzESo", genre: "bossa nova", language: "pt" },

                // Japanese Songs (J-Pop)
                { id: 36, title: "Sukiyaki", artist: "Kyu Sakamoto", album: "Sukiyaki and Other Japanese Hits", duration: "3:03", youtubeId: "C35DrtPlUbc", genre: "pop", language: "ja" },
                { id: 37, title: "Plastic Love", artist: "Mariya Takeuchi", album: "Variety", duration: "4:17", youtubeId: "3bNITQR4Uso", genre: "city pop", language: "ja" },
                { id: 38, title: "Stay With Me", artist: "Miki Matsubara", album: "Pocket Park", duration: "4:20", youtubeId: "VEe_yIbW64w", genre: "city pop", language: "ja" },
                { id: 39, title: "Mayonaka no Door", artist: "Miki Matsubara", album: "Pocket Park", duration: "3:50", youtubeId: "rTZO0rjUbGE", genre: "city pop", language: "ja" },
                { id: 40, title: "Ride on Time", artist: "Tatsuro Yamashita", album: "Ride on Time", duration: "4:58", youtubeId: "VWF4AHBaKAI", genre: "city pop", language: "ja" },

                // Korean Songs (K-Pop)
                { id: 41, title: "Gangnam Style", artist: "PSY", album: "Psy 6 (Six Rules), Part 1", duration: "3:39", youtubeId: "9bZkp7q19f0", genre: "k-pop", language: "ko" },
                { id: 42, title: "Dynamite", artist: "BTS", album: "BE", duration: "3:19", youtubeId: "gdZLi9oWNZg", genre: "k-pop", language: "ko" },
                { id: 43, title: "Butter", artist: "BTS", album: "Butter", duration: "2:44", youtubeId: "WMweEpGlu_U", genre: "k-pop", language: "ko" },
                { id: 44, title: "Boy With Luv", artist: "BTS ft. Halsey", album: "Map of the Soul: Persona", duration: "3:49", youtubeId: "XsX3ATc3FbA", genre: "k-pop", language: "ko" },
                { id: 45, title: "DNA", artist: "BTS", album: "Love Yourself: Her", duration: "3:43", youtubeId: "MBdVXkSdhwU", genre: "k-pop", language: "ko" },

                // Hindi Songs (Bollywood)
                { id: 46, title: "Jai Ho", artist: "A.R. Rahman", album: "Slumdog Millionaire", duration: "5:09", youtubeId: "YR12Z8f1Dh8", genre: "bollywood", language: "hi" },
                { id: 47, title: "Tum Hi Ho", artist: "Arijit Singh", album: "Aashiqui 2", duration: "4:22", youtubeId: "IJq0yyWug1k", genre: "bollywood", language: "hi" },
                { id: 48, title: "Channa Mereya", artist: "Arijit Singh", album: "Ae Dil Hai Mushkil", duration: "4:49", youtubeId: "bzSTpdcs-EI", genre: "bollywood", language: "hi" },
                { id: 49, title: "Raabta", artist: "Arijit Singh", album: "Agent Vinod", duration: "4:06", youtubeId: "eqcuoIy3W4M", genre: "bollywood", language: "hi" },
                { id: 50, title: "Gerua", artist: "Arijit Singh & Antara Mitra", album: "Dilwale", duration: "4:55", youtubeId: "AEIVhBS6baE", genre: "bollywood", language: "hi" },

                // Arabic Songs
                { id: 51, title: "Lamma Bada Yatathanna", artist: "Fairuz", album: "Classical Arabic", duration: "4:15", youtubeId: "RXaTbQJbIoE", genre: "arabic", language: "ar" },
                { id: 52, title: "Habibi Ya Nour El Ain", artist: "Amr Diab", album: "Nour El Ain", duration: "4:28", youtubeId: "dQw4w9WgXcQ", genre: "arabic", language: "ar" },
                { id: 53, title: "Tamally Maak", artist: "Amr Diab", album: "Tamally Maak", duration: "4:35", youtubeId: "dQw4w9WgXcQ", genre: "arabic", language: "ar" },
                { id: 54, title: "Wayah", artist: "Nancy Ajram", album: "Ya Salam", duration: "3:45", youtubeId: "dQw4w9WgXcQ", genre: "arabic", language: "ar" },
                { id: 55, title: "Ah W Noss", artist: "Nancy Ajram", album: "Ah W Noss", duration: "3:28", youtubeId: "dQw4w9WgXcQ", genre: "arabic", language: "ar" },

                // Russian Songs
                { id: 56, title: "Katyusha", artist: "Traditional", album: "Russian Folk", duration: "3:15", youtubeId: "7J__ZdvsZaE", genre: "folk", language: "ru" },
                { id: 57, title: "Moscow Nights", artist: "Traditional", album: "Russian Folk", duration: "4:20", youtubeId: "V8h8snfYidg", genre: "folk", language: "ru" },
                { id: 58, title: "Kalinka", artist: "Traditional", album: "Russian Folk", duration: "3:45", youtubeId: "m8OlDPqYBLw", genre: "folk", language: "ru" },
                { id: 59, title: "Gruppa Krovi", artist: "Kino", album: "Gruppa Krovi", duration: "4:28", youtubeId: "dQw4w9WgXcQ", genre: "rock", language: "ru" },
                { id: 60, title: "Zvezda po Imeni Solntse", artist: "Kino", album: "Zvezda po Imeni Solntse", duration: "3:45", youtubeId: "dQw4w9WgXcQ", genre: "rock", language: "ru" },

                // More English Songs
                { id: 61, title: "Bad Habit", artist: "Steve Lacy", album: "Gemini Rights", duration: "3:51", youtubeId: "VF-r5TtlT9w", genre: "hip-hop", language: "en" },
                { id: 62, title: "Heat Waves", artist: "Glass Animals", album: "Dreamland", duration: "3:58", youtubeId: "mRD0-GxqHVo", genre: "rock", language: "en" },
                { id: 63, title: "Bohemian Rhapsody", artist: "Queen", album: "A Night at the Opera", duration: "5:55", youtubeId: "fJ9rUzIMcZQ", genre: "rock", language: "en" },
                { id: 64, title: "Titanium", artist: "David Guetta ft. Sia", album: "Nothing but the Beat", duration: "4:05", youtubeId: "JRfuAukYTKg", genre: "electronic", language: "en" },
                { id: 65, title: "Wake Me Up", artist: "Avicii", album: "True", duration: "4:07", youtubeId: "IcrbM1l_BoI", genre: "electronic", language: "en" },
                { id: 66, title: "Uptown Funk", artist: "Mark Ronson ft. Bruno Mars", album: "Uptown Special", duration: "4:30", youtubeId: "OPf0YbXqDm0", genre: "r&b", language: "en" },
                { id: 67, title: "24K Magic", artist: "Bruno Mars", album: "24K Magic", duration: "3:46", youtubeId: "UqyT8IEBkvY", genre: "r&b", language: "en" },
                { id: 68, title: "Fly Me to the Moon", artist: "Frank Sinatra", album: "It Might as Well Be Swing", duration: "2:29", youtubeId: "5hxibHJOE5E", genre: "jazz", language: "en" },
                { id: 69, title: "My Way", artist: "Frank Sinatra", album: "My Way", duration: "4:35", youtubeId: "qQdBunz9Lps", genre: "jazz", language: "en" },
                { id: 70, title: "Canon in D", artist: "Johann Pachelbel", album: "Classical Masterpieces", duration: "4:24", youtubeId: "NlprozGcs80", genre: "classical", language: "en" },

                // Additional songs to reach 100+
                { id: 71, title: "Watermelon Sugar", artist: "Harry Styles", album: "Fine Line", duration: "2:54", youtubeId: "E07s5ZYygMg", genre: "pop", language: "en" },
                { id: 72, title: "Good 4 U", artist: "Olivia Rodrigo", album: "SOUR", duration: "2:58", youtubeId: "gNi_6U5Pm_o", genre: "pop", language: "en" },
                { id: 73, title: "Peaches", artist: "Justin Bieber ft. Daniel Caesar", album: "Justice", duration: "3:18", youtubeId: "tQ0yjYUFKAE", genre: "pop", language: "en" },
                { id: 74, title: "Bad Guy", artist: "Billie Eilish", album: "When We All Fall Asleep", duration: "3:14", youtubeId: "DyDfgMOUjCI", genre: "pop", language: "en" },
                { id: 75, title: "Drivers License", artist: "Olivia Rodrigo", album: "SOUR", duration: "4:02", youtubeId: "ZmDBbnmKpqQ", genre: "pop", language: "en" },
                { id: 76, title: "Waka Waka", artist: "Shakira", album: "Sale el Sol", duration: "3:22", youtubeId: "pRpeEdMmmQ0", genre: "pop", language: "es" },
                { id: 77, title: "Mi Gente", artist: "J Balvin & Willy William", album: "Energía", duration: "3:06", youtubeId: "qqpqmxqacvg", genre: "reggaeton", language: "es" },
                { id: 78, title: "Bailando", artist: "Enrique Iglesias", album: "Sex and Love", duration: "4:03", youtubeId: "NUsoVlDFqZg", genre: "pop", language: "es" },
                { id: 79, title: "Formidable", artist: "Stromae", album: "Racine Carrée", duration: "3:35", youtubeId: "S_xH7noaqTA", genre: "electronic", language: "fr" },
                { id: 80, title: "Tourner Dans Le Vide", artist: "Indila", album: "Mini World", duration: "3:19", youtubeId: "vtNJMAyeP0s", genre: "pop", language: "fr" },
                { id: 81, title: "Engel", artist: "Rammstein", album: "Sehnsucht", duration: "4:24", youtubeId: "x2rQzv8OWEY", genre: "metal", language: "de" },
                { id: 82, title: "Wind of Change", artist: "Scorpions", album: "Crazy World", duration: "5:12", youtubeId: "n4RjJKxsamQ", genre: "rock", language: "de" },
                { id: 83, title: "Azzurro", artist: "Adriano Celentano", album: "Azzurro", duration: "4:12", youtubeId: "cBJyo6lCNvs", genre: "pop", language: "it" },
                { id: 84, title: "Felicità", artist: "Al Bano & Romina Power", album: "Felicità", duration: "4:15", youtubeId: "Kp8-0r1TIQU", genre: "pop", language: "it" },
                { id: 85, title: "Chega de Saudade", artist: "João Gilberto", album: "Chega de Saudade", duration: "3:18", youtubeId: "b2BZyD7HdW0", genre: "bossa nova", language: "pt" },
                { id: 86, title: "Wave", artist: "Tom Jobim", album: "Wave", duration: "3:12", youtubeId: "9NPF_XkdUJA", genre: "bossa nova", language: "pt" },
                { id: 87, title: "Christmas Eve", artist: "Tatsuro Yamashita", album: "Melodies", duration: "4:12", youtubeId: "3bNITQR4Uso", genre: "city pop", language: "ja" },
                { id: 88, title: "Sparkle", artist: "Tatsuro Yamashita", album: "Sparkle", duration: "4:35", youtubeId: "pfmDdUGcVRs", genre: "city pop", language: "ja" },
                { id: 89, title: "Permission to Dance", artist: "BTS", album: "Butter", duration: "3:07", youtubeId: "CuklIb9d3fI", genre: "k-pop", language: "ko" },
                { id: 90, title: "IDOL", artist: "BTS", album: "Love Yourself: Answer", duration: "3:42", youtubeId: "pBuZEGYXA6E", genre: "k-pop", language: "ko" },
                { id: 91, title: "Kabira", artist: "Tochi Raina & Rekha Bhardwaj", album: "Yeh Jawaani Hai Deewani", duration: "4:18", youtubeId: "jHNNMj5bNQw", genre: "bollywood", language: "hi" },
                { id: 92, title: "Ilahi", artist: "Arijit Singh", album: "Yeh Jawaani Hai Deewani", duration: "5:02", youtubeId: "OOmyduPYOhw", genre: "bollywood", language: "hi" },
                { id: 93, title: "Nour El Ain", artist: "Amr Diab", album: "Nour El Ain", duration: "4:12", youtubeId: "dQw4w9WgXcQ", genre: "arabic", language: "ar" },
                { id: 94, title: "Akhasmak Ah", artist: "Nancy Ajram", album: "Ya Salam", duration: "3:52", youtubeId: "dQw4w9WgXcQ", genre: "arabic", language: "ar" },
                { id: 95, title: "Polyushka Polye", artist: "Traditional", album: "Russian Folk", duration: "5:30", youtubeId: "dQw4w9WgXcQ", genre: "folk", language: "ru" },
                { id: 96, title: "Pachka Sigaret", artist: "Kino", album: "Gruppa Krovi", duration: "4:15", youtubeId: "dQw4w9WgXcQ", genre: "rock", language: "ru" },
                { id: 97, title: "Industry Baby", artist: "Lil Nas X ft. Jack Harlow", album: "MONTERO", duration: "3:32", youtubeId: "UTHLKHL_whs", genre: "hip-hop", language: "en" },
                { id: 98, title: "Don't Stop Me Now", artist: "Queen", album: "Jazz", duration: "3:29", youtubeId: "HgzGwKwLmgM", genre: "rock", language: "en" },
                { id: 99, title: "Levels", artist: "Avicii", album: "True", duration: "3:18", youtubeId: "_ovdm2yX4MA", genre: "electronic", language: "en" },
                { id: 100, title: "That's What I Like", artist: "Bruno Mars", album: "24K Magic", duration: "3:26", youtubeId: "PMivT7MJ41M", genre: "r&b", language: "en" }
            ]
        };

        // Global variables
        let currentUser = null;
        let currentTrack = null;
        let isPlaying = false;
        let currentPlaylist = [];
        let currentTrackIndex = 0;
        let isShuffled = false;
        let repeatMode = 'off'; // 'off', 'all', 'one'
        let volume = 0.7;
        let isMuted = false;
        let isAutoplay = true;
        let currentLanguageFilter = 'all';
        let youtubePlayer = null;
        let isVoiceListening = false;
        let freeTimeRemaining = 4 * 60 * 60; // 4 hours in seconds
        let timeInterval = null;

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            loadYouTubeAPI();
            populateHomeContent();
            startFreeTimeCountdown();
            updateOnlineUsers();
        });

        function initializeApp() {
            // Check for saved user data
            const savedUser = localStorage.getItem('soundifyUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUIForUser();
            }

            // Load saved preferences
            const savedVolume = localStorage.getItem('soundifyVolume');
            if (savedVolume) {
                volume = parseFloat(savedVolume);
                updateVolumeDisplay();
            }

            const savedAutoplay = localStorage.getItem('soundifyAutoplay');
            if (savedAutoplay !== null) {
                isAutoplay = savedAutoplay === 'true';
                updateAutoplayToggle();
            }
        }

        function loadYouTubeAPI() {
            // Load YouTube IFrame API
            const tag = document.createElement('script');
            tag.src = 'https://www.youtube.com/iframe_api';
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        // YouTube API ready callback
        function onYouTubeIframeAPIReady() {
            youtubePlayer = new YT.Player('youtubePlayer', {
                height: '0',
                width: '0',
                playerVars: {
                    'playsinline': 1,
                    'controls': 0,
                    'disablekb': 1,
                    'fs': 0,
                    'modestbranding': 1,
                    'rel': 0
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            youtubePlayer.setVolume(volume * 100);
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.ENDED) {
                if (isAutoplay) {
                    nextTrack();
                } else {
                    stopPlayback();
                }
            } else if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                updatePlayButton();
                startProgressUpdate();
            } else if (event.data === YT.PlayerState.PAUSED) {
                isPlaying = false;
                updatePlayButton();
                stopProgressUpdate();
            }
        }

        let progressInterval;

        function startProgressUpdate() {
            stopProgressUpdate();
            progressInterval = setInterval(updateProgress, 1000);
        }

        function stopProgressUpdate() {
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }
        }

        function updateProgress() {
            if (youtubePlayer && youtubePlayer.getCurrentTime) {
                const currentTime = youtubePlayer.getCurrentTime();
                const duration = youtubePlayer.getDuration();
                
                if (duration > 0) {
                    const progress = (currentTime / duration) * 100;
                    document.getElementById('progress').style.width = progress + '%';
                    document.getElementById('currentTime').textContent = formatTime(currentTime);
                    document.getElementById('duration').textContent = formatTime(duration);
                }
            }
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Navigation functions
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName + 'Section').classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.target.closest('.nav-link').classList.add('active');
        }

        function goBack() {
            // Implement navigation history
            showVoiceFeedback('Going back...');
        }

        function goForward() {
            // Implement navigation history
            showVoiceFeedback('Going forward...');
        }

        // Search functionality
        function handleSearch(event) {
            const query = event.target.value.toLowerCase();
            if (query.length > 2) {
                const results = musicData.tracks.filter(track => 
                    track.title.toLowerCase().includes(query) ||
                    track.artist.toLowerCase().includes(query) ||
                    track.album.toLowerCase().includes(query)
                );
                displaySearchResults(results);
            } else if (query.length === 0) {
                hideSearchResults();
            }
        }

        function displaySearchResults(results) {
            const searchResults = document.getElementById('searchResults');
            const searchResultsList = document.getElementById('searchResultsList');
            
            searchResults.classList.add('active');
            searchResultsList.innerHTML = '';
            
            results.forEach((track, index) => {
                const trackElement = createTrackElement(track, index + 1);
                searchResultsList.appendChild(trackElement);
            });
        }

        function hideSearchResults() {
            document.getElementById('searchResults').classList.remove('active');
        }

        function createTrackElement(track, number) {
            const trackDiv = document.createElement('div');
            trackDiv.className = 'track-item';
            trackDiv.onclick = () => playTrack(track);
            
            trackDiv.innerHTML = `
                <div class="track-number">${number}</div>
                <div class="track-image">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                        <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
                    </svg>
                </div>
                <div class="track-info">
                    <div class="track-title">${track.title}</div>
                    <div class="track-artist">${track.artist}</div>
                </div>
                <div class="track-album">${track.album}</div>
                <div class="track-duration">${track.duration}</div>
                <div class="track-actions">
                    <button class="action-btn" onclick="event.stopPropagation(); toggleLikeTrack(${track.id})">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                    </button>
                    <button class="action-btn" onclick="event.stopPropagation(); addToPlaylist(${track.id})">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                    </button>
                </div>
            `;
            
            return trackDiv;
        }

        // Language filtering
        function filterByLanguage(language) {
            currentLanguageFilter = language;
            
            // Update active button
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Filter and display results
            let filteredTracks;
            if (language === 'all') {
                filteredTracks = musicData.tracks;
            } else {
                filteredTracks = musicData.tracks.filter(track => track.language === language);
            }
            
            displaySearchResults(filteredTracks);
        }

        function searchByGenre(genre) {
            const filteredTracks = musicData.tracks.filter(track => 
                track.genre.toLowerCase().includes(genre.toLowerCase())
            );
            displaySearchResults(filteredTracks);
        }

        // Player functions
        function playTrack(track) {
            if (!currentUser && !checkFreeTimeRemaining()) {
                showModal('timeLimitModal');
                return;
            }

            currentTrack = track;
            updateCurrentTrackDisplay();
            
            if (youtubePlayer && youtubePlayer.loadVideoById) {
                youtubePlayer.loadVideoById(track.youtubeId);
                youtubePlayer.setVolume(volume * 100);
            }
            
            // Add to recently played
            addToRecentlyPlayed(track);
        }

        function togglePlay() {
            if (!currentTrack) {
                // Play first track from current playlist or all tracks
                const tracksToPlay = currentPlaylist.length > 0 ? currentPlaylist : musicData.tracks;
                if (tracksToPlay.length > 0) {
                    playTrack(tracksToPlay[0]);
                }
                return;
            }

            if (youtubePlayer) {
                if (isPlaying) {
                    youtubePlayer.pauseVideo();
                } else {
                    youtubePlayer.playVideo();
                }
            }
        }

        function previousTrack() {
            if (currentPlaylist.length === 0) return;
            
            currentTrackIndex = currentTrackIndex > 0 ? currentTrackIndex - 1 : currentPlaylist.length - 1;
            playTrack(currentPlaylist[currentTrackIndex]);
        }

        function nextTrack() {
            if (currentPlaylist.length === 0) {
                // Auto-generate playlist from current language filter
                generateAutoPlaylist();
            }
            
            if (repeatMode === 'one') {
                playTrack(currentTrack);
                return;
            }
            
            if (isShuffled) {
                currentTrackIndex = Math.floor(Math.random() * currentPlaylist.length);
            } else {
                currentTrackIndex = (currentTrackIndex + 1) % currentPlaylist.length;
            }
            
            playTrack(currentPlaylist[currentTrackIndex]);
        }

        function generateAutoPlaylist() {
            let tracks = musicData.tracks;
            if (currentLanguageFilter !== 'all') {
                tracks = tracks.filter(track => track.language === currentLanguageFilter);
            }
            
            // Shuffle the tracks for variety
            currentPlaylist = [...tracks].sort(() => Math.random() - 0.5);
            currentTrackIndex = 0;
        }

        function toggleShuffle() {
            isShuffled = !isShuffled;
            const shuffleButton = document.getElementById('shuffleButton');
            shuffleButton.classList.toggle('active', isShuffled);
            
            if (isShuffled && currentPlaylist.length > 0) {
                // Reshuffle current playlist
                const currentTrackId = currentTrack ? currentTrack.id : null;
                currentPlaylist = [...currentPlaylist].sort(() => Math.random() - 0.5);
                
                // Find current track in shuffled playlist
                if (currentTrackId) {
                    currentTrackIndex = currentPlaylist.findIndex(track => track.id === currentTrackId);
                }
            }
        }

        function toggleRepeat() {
            const modes = ['off', 'all', 'one'];
            const currentIndex = modes.indexOf(repeatMode);
            repeatMode = modes[(currentIndex + 1) % modes.length];
            
            const repeatButton = document.getElementById('repeatButton');
            repeatButton.classList.toggle('active', repeatMode !== 'off');
            
            // Update button appearance based on mode
            if (repeatMode === 'one') {
                repeatButton.style.color = '#1DB954';
            } else if (repeatMode === 'all') {
                repeatButton.style.color = 'white';
            } else {
                repeatButton.style.color = '#b3b3b3';
            }
        }

        function toggleAutoplay() {
            isAutoplay = !isAutoplay;
            const autoplayToggle = document.getElementById('autoplayToggle');
            autoplayToggle.classList.toggle('active', isAutoplay);
            
            localStorage.setItem('soundifyAutoplay', isAutoplay.toString());
        }

        function updateAutoplayToggle() {
            const autoplayToggle = document.getElementById('autoplayToggle');
            autoplayToggle.classList.toggle('active', isAutoplay);
        }

        function seekTo(event) {
            if (!youtubePlayer || !currentTrack) return;
            
            const progressBar = event.currentTarget;
            const rect = progressBar.getBoundingClientRect();
            const percent = (event.clientX - rect.left) / rect.width;
            const duration = youtubePlayer.getDuration();
            const seekTime = duration * percent;
            
            youtubePlayer.seekTo(seekTime);
        }

        function setVolume(event) {
            const volumeBar = event.currentTarget;
            const rect = volumeBar.getBoundingClientRect();
            const percent = (event.clientX - rect.left) / rect.width;
            
            volume = Math.max(0, Math.min(1, percent));
            updateVolumeDisplay();
            
            if (youtubePlayer) {
                youtubePlayer.setVolume(volume * 100);
            }
            
            localStorage.setItem('soundifyVolume', volume.toString());
        }

        function toggleMute() {
            isMuted = !isMuted;
            
            if (youtubePlayer) {
                if (isMuted) {
                    youtubePlayer.setVolume(0);
                } else {
                    youtubePlayer.setVolume(volume * 100);
                }
            }
            
            updateVolumeDisplay();
        }

        function updateVolumeDisplay() {
            const volumeLevel = document.getElementById('volumeLevel');
            const volumeIcon = document.getElementById('volumeIcon');
            
            if (isMuted || volume === 0) {
                volumeLevel.style.width = '0%';
                volumeIcon.innerHTML = '<path d="M11 5L6 9H2v6h4l5 4V5zM23 9l-2 2-2-2-2 2 2 2-2 2 2 2 2-2 2 2 2-2-2-2 2-2z"/>';
            } else {
                volumeLevel.style.width = (volume * 100) + '%';
                if (volume < 0.3) {
                    volumeIcon.innerHTML = '<path d="M11 5L6 9H2v6h4l5 4V5zM15.54 8.46a5 5 0 0 1 0 7.07l-1.41-1.41a3 3 0 0 0 0-4.24l1.41-1.42z"/>';
                } else {
                    volumeIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>';
                }
            }
        }

        function updatePlayButton() {
            const playIcon = document.getElementById('playIcon');
            const pauseIcon = document.getElementById('pauseIcon');
            
            if (isPlaying) {
                playIcon.classList.add('hidden');
                pauseIcon.classList.remove('hidden');
            } else {
                playIcon.classList.remove('hidden');
                pauseIcon.classList.add('hidden');
            }
        }

        function updateCurrentTrackDisplay() {
            if (currentTrack) {
                document.getElementById('currentTrackTitle').textContent = currentTrack.title;
                document.getElementById('currentTrackArtist').textContent = currentTrack.artist;
            }
        }

        function stopPlayback() {
            if (youtubePlayer) {
                youtubePlayer.stopVideo();
            }
            isPlaying = false;
            updatePlayButton();
            stopProgressUpdate();
        }

        // Playlist functions
        function playPlaylist(type) {
            let tracks = [];
            
            switch(type) {
                case 'liked':
                    tracks = getLikedSongs();
                    break;
                case 'discover':
                    tracks = getDiscoverWeekly();
                    break;
                case 'mix':
                    tracks = getYourMix();
                    break;
            }
            
            if (tracks.length > 0) {
                currentPlaylist = tracks;
                currentTrackIndex = 0;
                playTrack(tracks[0]);
            }
        }

        function getLikedSongs() {
            const likedSongs = JSON.parse(localStorage.getItem('soundifyLikedSongs') || '[]');
            return musicData.tracks.filter(track => likedSongs.includes(track.id));
        }

        function getDiscoverWeekly() {
            // Generate a random selection of 30 songs
            const shuffled = [...musicData.tracks].sort(() => Math.random() - 0.5);
            return shuffled.slice(0, 30);
        }

        function getYourMix() {
            // Mix based on user's listening history and preferences
            const recentlyPlayed = JSON.parse(localStorage.getItem('soundifyRecentlyPlayed') || '[]');
            const likedSongs = JSON.parse(localStorage.getItem('soundifyLikedSongs') || '[]');
            
            // Get genres from liked and recently played songs
            const preferredGenres = new Set();
            const preferredLanguages = new Set();
            
            [...recentlyPlayed, ...likedSongs].forEach(trackId => {
                const track = musicData.tracks.find(t => t.id === trackId);
                if (track) {
                    preferredGenres.add(track.genre);
                    preferredLanguages.add(track.language);
                }
            });
            
            // Filter tracks based on preferences
            let mixTracks = musicData.tracks.filter(track => 
                preferredGenres.has(track.genre) || preferredLanguages.has(track.language)
            );
            
            // If no preferences, use popular tracks
            if (mixTracks.length === 0) {
                mixTracks = musicData.tracks.filter(track => track.genre === 'pop');
            }
            
            return mixTracks.sort(() => Math.random() - 0.5).slice(0, 50);
        }

        function createPlaylist() {
            showModal('playlistModal');
        }

        function submitPlaylist(event) {
            event.preventDefault();
            
            const name = document.getElementById('playlistName').value;
            const description = document.getElementById('playlistDescription').value;
            
            // Save playlist to localStorage
            const playlists = JSON.parse(localStorage.getItem('soundifyPlaylists') || '[]');
            const newPlaylist = {
                id: Date.now(),
                name: name,
                description: description,
                tracks: [],
                createdAt: new Date().toISOString()
            };
            
            playlists.push(newPlaylist);
            localStorage.setItem('soundifyPlaylists', JSON.stringify(playlists));
            
            closeModal('playlistModal');
            showVoiceFeedback(`Playlist "${name}" created!`);
            
            // Reset form
            document.getElementById('playlistName').value = '';
            document.getElementById('playlistDescription').value = '';
        }

        // Like functionality
        function toggleLike() {
            if (!currentTrack) return;
            toggleLikeTrack(currentTrack.id);
        }

        function toggleLikeTrack(trackId) {
            const likedSongs = JSON.parse(localStorage.getItem('soundifyLikedSongs') || '[]');
            const likeButton = document.getElementById('likeButton');
            
            if (likedSongs.includes(trackId)) {
                // Remove from liked songs
                const index = likedSongs.indexOf(trackId);
                likedSongs.splice(index, 1);
                likeButton.classList.remove('liked');
            } else {
                // Add to liked songs
                likedSongs.push(trackId);
                likeButton.classList.add('liked');
            }
            
            localStorage.setItem('soundifyLikedSongs', JSON.stringify(likedSongs));
        }

        function addToRecentlyPlayed(track) {
            const recentlyPlayed = JSON.parse(localStorage.getItem('soundifyRecentlyPlayed') || '[]');
            
            // Remove if already exists
            const index = recentlyPlayed.indexOf(track.id);
            if (index > -1) {
                recentlyPlayed.splice(index, 1);
            }
            
            // Add to beginning
            recentlyPlayed.unshift(track.id);
            
            // Keep only last 50
            if (recentlyPlayed.length > 50) {
                recentlyPlayed.splice(50);
            }
            
            localStorage.setItem('soundifyRecentlyPlayed', JSON.stringify(recentlyPlayed));
        }

        // Voice control
        function toggleVoiceControl() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                showVoiceFeedback('Voice control not supported in this browser');
                return;
            }

            if (isVoiceListening) {
                stopVoiceRecognition();
            } else {
                startVoiceRecognition();
            }
        }

        function startVoiceRecognition() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';
            
            recognition.onstart = function() {
                isVoiceListening = true;
                document.getElementById('voiceBtn').classList.add('listening');
                showVoiceFeedback('Listening...');
            };
            
            recognition.onresult = function(event) {
                const command = event.results[0][0].transcript.toLowerCase();
                processVoiceCommand(command);
            };
            
            recognition.onerror = function(event) {
                showVoiceFeedback('Voice recognition error');
                stopVoiceRecognition();
            };
            
            recognition.onend = function() {
                stopVoiceRecognition();
            };
            
            recognition.start();
        }

        function stopVoiceRecognition() {
            isVoiceListening = false;
            document.getElementById('voiceBtn').classList.remove('listening');
            hideVoiceFeedback();
        }

        function processVoiceCommand(command) {
            showVoiceFeedback(`Processing: "${command}"`);
            
            if (command.includes('play')) {
                if (command.includes('next') || command.includes('skip')) {
                    nextTrack();
                } else if (command.includes('previous') || command.includes('back')) {
                    previousTrack();
                } else {
                    // Search for song
                    const songName = command.replace('play', '').trim();
                    const track = musicData.tracks.find(t => 
                        t.title.toLowerCase().includes(songName) ||
                        t.artist.toLowerCase().includes(songName)
                    );
                    if (track) {
                        playTrack(track);
                        showVoiceFeedback(`Playing ${track.title}`);
                    } else {
                        togglePlay();
                    }
                }
            } else if (command.includes('pause') || command.includes('stop')) {
                if (isPlaying) {
                    togglePlay();
                    showVoiceFeedback('Paused');
                }
            } else if (command.includes('volume')) {
                if (command.includes('up') || command.includes('increase')) {
                    volume = Math.min(1, volume + 0.1);
                    updateVolumeDisplay();
                    if (youtubePlayer) youtubePlayer.setVolume(volume * 100);
                    showVoiceFeedback('Volume up');
                } else if (command.includes('down') || command.includes('decrease')) {
                    volume = Math.max(0, volume - 0.1);
                    updateVolumeDisplay();
                    if (youtubePlayer) youtubePlayer.setVolume(volume * 100);
                    showVoiceFeedback('Volume down');
                }
            } else if (command.includes('shuffle')) {
                if (command.includes('on') || !isShuffled) {
                    if (!isShuffled) toggleShuffle();
                    showVoiceFeedback('Shuffle on');
                } else {
                    if (isShuffled) toggleShuffle();
                    showVoiceFeedback('Shuffle off');
                }
            } else if (command.includes('search')) {
                const query = command.replace('search', '').replace('for', '').trim();
                document.getElementById('searchInput').value = query;
                handleSearch({ target: { value: query } });
                showVoiceFeedback(`Searching for ${query}`);
            } else {
                showVoiceFeedback('Command not recognized');
            }
        }

        function showVoiceFeedback(message) {
            const feedback = document.getElementById('voiceFeedback');
            feedback.textContent = message;
            feedback.classList.add('show');
            
            setTimeout(() => {
                hideVoiceFeedback();
            }, 3000);
        }

        function hideVoiceFeedback() {
            document.getElementById('voiceFeedback').classList.remove('show');
        }

        // Free time management
        function startFreeTimeCountdown() {
            if (currentUser && currentUser.isPremium) return;
            
            const savedTime = localStorage.getItem('soundifyFreeTime');
            if (savedTime) {
                freeTimeRemaining = parseInt(savedTime);
            }
            
            timeInterval = setInterval(() => {
                if (!currentUser || !currentUser.isPremium) {
                    freeTimeRemaining--;
                    localStorage.setItem('soundifyFreeTime', freeTimeRemaining.toString());
                    updateTimeDisplay();
                    
                    if (freeTimeRemaining <= 0) {
                        showModal('timeLimitModal');
                        stopPlayback();
                    }
                }
            }, 1000);
        }

        function updateTimeDisplay() {
            if (currentUser && currentUser.isPremium) {
                document.getElementById('timeRemaining').classList.add('hidden');
                return;
            }
            
            const hours = Math.floor(freeTimeRemaining / 3600);
            const minutes = Math.floor((freeTimeRemaining % 3600) / 60);
            const seconds = freeTimeRemaining % 60;
            
            const timeString = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timeLeft').textContent = timeString;
            document.getElementById('timeRemaining').classList.remove('hidden');
        }

        function checkFreeTimeRemaining() {
            return freeTimeRemaining > 0;
        }

        // Authentication (Mock)
        function signInWithGoogle() {
            // Mock Google sign-in
            const mockUser = {
                id: 'user_' + Date.now(),
                name: 'Music Lover',
                email: 'user@example.com',
                isPremium: false,
                avatar: null
            };
            
            currentUser = mockUser;
            localStorage.setItem('soundifyUser', JSON.stringify(mockUser));
            updateUIForUser();
            showVoiceFeedback('Signed in successfully!');
        }

        function signOut() {
            currentUser = null;
            localStorage.removeItem('soundifyUser');
            updateUIForUser();
            showVoiceFeedback('Signed out');
        }

        function updateUIForUser() {
            const authButtons = document.getElementById('authButtons');
            const userProfile = document.getElementById('userProfile');
            const premiumBadge = document.getElementById('premiumBadge');
            const upgradeBtn = document.getElementById('upgradeBtn');
            
            if (currentUser) {
                authButtons.classList.add('hidden');
                userProfile.classList.remove('hidden');
                
                if (currentUser.isPremium) {
                    premiumBadge.classList.remove('hidden');
                    upgradeBtn.textContent = 'Premium';
                    upgradeBtn.style.background = '#ffd700';
                    upgradeBtn.style.color = 'black';
                    document.getElementById('timeRemaining').classList.add('hidden');
                } else {
                    premiumBadge.classList.add('hidden');
                    upgradeBtn.textContent = 'Upgrade';
                    upgradeBtn.style.background = '#1DB954';
                    upgradeBtn.style.color = 'black';
                    updateTimeDisplay();
                }
            } else {
                authButtons.classList.remove('hidden');
                userProfile.classList.add('hidden');
                premiumBadge.classList.add('hidden');
                updateTimeDisplay();
            }
        }

        function togglePremium() {
            if (!currentUser) {
                signInWithGoogle();
                return;
            }
            
            if (currentUser.isPremium) {
                showProfile();
            } else {
                // Show premium upgrade options
                showVoiceFeedback('Upgrade to Premium for unlimited listening!');
                // In a real app, this would redirect to payment
                currentUser.isPremium = true;
                localStorage.setItem('soundifyUser', JSON.stringify(currentUser));
                updateUIForUser();
                showVoiceFeedback('Welcome to Premium!');
            }
        }

        function showProfile() {
            if (!currentUser) return;
            
            document.getElementById('displayName').value = currentUser.name;
            document.getElementById('bio').value = currentUser.bio || '';
            document.getElementById('favoriteGenre').value = currentUser.favoriteGenre || 'pop';
            
            showModal('profileModal');
        }

        function updateProfile(event) {
            event.preventDefault();
            
            if (!currentUser) return;
            
            currentUser.name = document.getElementById('displayName').value;
            currentUser.bio = document.getElementById('bio').value;
            currentUser.favoriteGenre = document.getElementById('favoriteGenre').value;
            
            localStorage.setItem('soundifyUser', JSON.stringify(currentUser));
            closeModal('profileModal');
            showVoiceFeedback('Profile updated!');
        }

        // Modal functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // Click outside modal to close
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
            }
        });

        // Populate home content
        function populateHomeContent() {
            populateRecentlyPlayed();
            populateMadeForYou();
            populatePopularPlaylists();
        }

        function populateRecentlyPlayed() {
            const container = document.getElementById('recentlyPlayed');
            const recentlyPlayed = JSON.parse(localStorage.getItem('soundifyRecentlyPlayed') || '[]');
            
            container.innerHTML = '';
            
            const tracksToShow = recentlyPlayed.slice(0, 6).map(id => 
                musicData.tracks.find(track => track.id === id)
            ).filter(Boolean);
            
            // If no recently played, show popular tracks
            if (tracksToShow.length === 0) {
                tracksToShow.push(...musicData.tracks.slice(0, 6));
            }
            
            tracksToShow.forEach(track => {
                const card = createTrackCard(track);
                container.appendChild(card);
            });
        }

        function populateMadeForYou() {
            const container = document.getElementById('madeForYou');
            container.innerHTML = '';
            
            // Generate personalized playlists
            const playlists = [
                { name: 'Discover Weekly', description: 'Your weekly mixtape of fresh music', tracks: getDiscoverWeekly() },
                { name: 'Release Radar', description: 'New music from artists you follow', tracks: musicData.tracks.slice(10, 40) },
                { name: 'Daily Mix 1', description: 'Taylor Swift, Harry Styles and more', tracks: musicData.tracks.filter(t => t.genre === 'pop').slice(0, 30) },
                { name: 'Daily Mix 2', description: 'BTS, BLACKPINK and more', tracks: musicData.tracks.filter(t => t.language === 'ko').slice(0, 30) },
                { name: 'Chill Mix', description: 'Relax with these calm vibes', tracks: musicData.tracks.filter(t => t.genre === 'bossa nova' || t.genre === 'jazz').slice(0, 30) },
                { name: 'Workout Mix', description: 'High energy tracks for your workout', tracks: musicData.tracks.filter(t => t.genre === 'electronic' || t.genre === 'hip-hop').slice(0, 30) }
            ];
            
            playlists.forEach(playlist => {
                const card = createPlaylistCard(playlist);
                container.appendChild(card);
            });
        }

        function populatePopularPlaylists() {
            const container = document.getElementById('popularPlaylists');
            container.innerHTML = '';
            
            const popularPlaylists = [
                { name: 'Today\'s Top Hits', description: 'The most played songs right now', tracks: musicData.tracks.slice(0, 60) },
                { name: 'Global Top 50', description: 'The most played songs globally', tracks: musicData.tracks.slice(5, 95) },
                { name: 'Viral 50', description: 'The most viral tracks right now', tracks: musicData.tracks.slice(10, 100) },
                { name: 'New Music Friday', description: 'The best new music, updated weekly', tracks: musicData.tracks.slice(15, 107) },
                { name: 'RapCaviar', description: 'New music and deep cuts', tracks: musicData.tracks.filter(t => t.genre === 'hip-hop') },
                { name: 'Rock Classics', description: 'Legendary rock anthems', tracks: musicData.tracks.filter(t => t.genre === 'rock') }
            ];
            
            popularPlaylists.forEach(playlist => {
                const card = createPlaylistCard(playlist);
                container.appendChild(card);
            });
        }

        function createTrackCard(track) {
            const card = document.createElement('div');
            card.className = 'card';
            card.onclick = () => playTrack(track);
            
            card.innerHTML = `
                <div class="card-image">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="white">
                        <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
                    </svg>
                    <button class="play-btn" onclick="event.stopPropagation(); playTrack(${JSON.stringify(track).replace(/"/g, '&quot;')})">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                    </button>
                </div>
                <div class="card-title">${track.title}</div>
                <div class="card-subtitle">${track.artist}</div>
            `;
            
            return card;
        }

        function createPlaylistCard(playlist) {
            const card = document.createElement('div');
            card.className = 'card';
            card.onclick = () => playPlaylistTracks(playlist.tracks);
            
            card.innerHTML = `
                <div class="card-image">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="white">
                        <path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/>
                    </svg>
                    <button class="play-btn" onclick="event.stopPropagation(); playPlaylistTracks(${JSON.stringify(playlist.tracks).replace(/"/g, '&quot;')})">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                    </button>
                </div>
                <div class="card-title">${playlist.name}</div>
                <div class="card-subtitle">${playlist.description}</div>
            `;
            
            return card;
        }

        function playPlaylistTracks(tracks) {
            if (tracks && tracks.length > 0) {
                currentPlaylist = tracks;
                currentTrackIndex = 0;
                playTrack(tracks[0]);
            }
        }

        // Library functions
        function filterLibrary(type) {
            // Update active button
            const buttons = document.querySelectorAll('#librarySection button');
            buttons.forEach(btn => {
                btn.className = btn.textContent.toLowerCase().includes(type) || (type === 'all' && btn.textContent === 'All') 
                    ? 'btn-primary' : 'btn-secondary';
            });
            
            const container = document.getElementById('libraryContent');
            container.innerHTML = '';
            
            switch(type) {
                case 'playlists':
                    showUserPlaylists(container);
                    break;
                case 'artists':
                    showUserArtists(container);
                    break;
                case 'albums':
                    showUserAlbums(container);
                    break;
                default:
                    showAllLibraryContent(container);
            }
        }

        function showUserPlaylists(container) {
            const playlists = JSON.parse(localStorage.getItem('soundifyPlaylists') || '[]');
            
            if (playlists.length === 0) {
                container.innerHTML = '<p style="color: #b3b3b3; text-align: center; margin-top: 48px;">No playlists yet. Create your first playlist!</p>';
                return;
            }
            
            const grid = document.createElement('div');
            grid.className = 'content-grid';
            
            playlists.forEach(playlist => {
                const card = createPlaylistCard({
                    name: playlist.name,
                    description: playlist.description || `${playlist.tracks.length} songs`,
                    tracks: playlist.tracks.map(id => musicData.tracks.find(t => t.id === id)).filter(Boolean)
                });
                grid.appendChild(card);
            });
            
            container.appendChild(grid);
        }

        function showUserArtists(container) {
            const recentlyPlayed = JSON.parse(localStorage.getItem('soundifyRecentlyPlayed') || '[]');
            const likedSongs = JSON.parse(localStorage.getItem('soundifyLikedSongs') || '[]');
            
            const artistCounts = {};
            [...recentlyPlayed, ...likedSongs].forEach(trackId => {
                const track = musicData.tracks.find(t => t.id === trackId);
                if (track) {
                    artistCounts[track.artist] = (artistCounts[track.artist] || 0) + 1;
                }
            });
            
            const sortedArtists = Object.entries(artistCounts)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 20);
            
            if (sortedArtists.length === 0) {
                container.innerHTML = '<p style="color: #b3b3b3; text-align: center; margin-top: 48px;">No artists in your library yet. Start listening to music!</p>';
                return;
            }
            
            const grid = document.createElement('div');
            grid.className = 'content-grid';
            
            sortedArtists.forEach(([artist, count]) => {
                const artistTracks = musicData.tracks.filter(t => t.artist === artist);
                const card = createPlaylistCard({
                    name: artist,
                    description: `${count} plays • ${artistTracks.length} songs`,
                    tracks: artistTracks
                });
                grid.appendChild(card);
            });
            
            container.appendChild(grid);
        }

        function showUserAlbums(container) {
            const recentlyPlayed = JSON.parse(localStorage.getItem('soundifyRecentlyPlayed') || '[]');
            const likedSongs = JSON.parse(localStorage.getItem('soundifyLikedSongs') || '[]');
            
            const albumCounts = {};
            [...recentlyPlayed, ...likedSongs].forEach(trackId => {
                const track = musicData.tracks.find(t => t.id === trackId);
                if (track) {
                    const key = `${track.album}|${track.artist}`;
                    albumCounts[key] = (albumCounts[key] || 0) + 1;
                }
            });
            
            const sortedAlbums = Object.entries(albumCounts)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 20);
            
            if (sortedAlbums.length === 0) {
                container.innerHTML = '<p style="color: #b3b3b3; text-align: center; margin-top: 48px;">No albums in your library yet. Start listening to music!</p>';
                return;
            }
            
            const grid = document.createElement('div');
            grid.className = 'content-grid';
            
            sortedAlbums.forEach(([albumKey, count]) => {
                const [album, artist] = albumKey.split('|');
                const albumTracks = musicData.tracks.filter(t => t.album === album && t.artist === artist);
                const card = createPlaylistCard({
                    name: album,
                    description: `${artist} • ${albumTracks.length} songs`,
                    tracks: albumTracks
                });
                grid.appendChild(card);
            });
            
            container.appendChild(grid);
        }

        function showAllLibraryContent(container) {
            // Show a mix of playlists, recent artists, and albums
            const allContent = document.createElement('div');
            
            // Recently played section
            const recentSection = document.createElement('div');
            recentSection.innerHTML = '<h3 style="margin-bottom: 16px;">Recently Played</h3>';
            const recentGrid = document.createElement('div');
            recentGrid.className = 'content-grid';
            
            const recentlyPlayed = JSON.parse(localStorage.getItem('soundifyRecentlyPlayed') || '[]');
            const recentTracks = recentlyPlayed.slice(0, 6).map(id => 
                musicData.tracks.find(track => track.id === id)
            ).filter(Boolean);
            
            recentTracks.forEach(track => {
                const card = createTrackCard(track);
                recentGrid.appendChild(card);
            });
            
            recentSection.appendChild(recentGrid);
            allContent.appendChild(recentSection);
            
            // Liked songs section
            const likedSection = document.createElement('div');
            likedSection.innerHTML = '<h3 style="margin: 32px 0 16px 0;">Liked Songs</h3>';
            const likedGrid = document.createElement('div');
            likedGrid.className = 'content-grid';
            
            const likedSongs = JSON.parse(localStorage.getItem('soundifyLikedSongs') || '[]');
            const likedTracks = likedSongs.slice(0, 6).map(id => 
                musicData.tracks.find(track => track.id === id)
            ).filter(Boolean);
            
            if (likedTracks.length > 0) {
                likedTracks.forEach(track => {
                    const card = createTrackCard(track);
                    likedGrid.appendChild(card);
                });
                likedSection.appendChild(likedGrid);
                allContent.appendChild(likedSection);
            }
            
            container.appendChild(allContent);
        }

        function showLikedSongs() {
            const likedSongs = getLikedSongs();
            if (likedSongs.length > 0) {
                currentPlaylist = likedSongs;
                currentTrackIndex = 0;
                playTrack(likedSongs[0]);
                showVoiceFeedback(`Playing ${likedSongs.length} liked songs`);
            } else {
                showVoiceFeedback('No liked songs yet. Like some songs to create your collection!');
            }
        }

        // Additional utility functions
        function toggleQueue() {
            showVoiceFeedback('Queue feature coming soon!');
        }

        function toggleDevices() {
            showVoiceFeedback('Device selection coming soon!');
        }

        function addToPlaylist(trackId) {
            showVoiceFeedback('Add to playlist feature coming soon!');
        }

        function updateOnlineUsers() {
            // Simulate online user count
            const count = Math.floor(Math.random() * 1000) + 1000;
            document.getElementById('onlineCount').textContent = `🟢 ${count.toLocaleString()} users online`;
            
            // Update every 30 seconds
            setTimeout(updateOnlineUsers, 30000);
        }

        // Initialize filter library on load
        setTimeout(() => {
            filterLibrary('all');
        }, 100);

        // Make functions globally available
        window.showSection = showSection;
        window.goBack = goBack;
        window.goForward = goForward;
        window.handleSearch = handleSearch;
        window.filterByLanguage = filterByLanguage;
        window.searchByGenre = searchByGenre;
        window.playTrack = playTrack;
        window.togglePlay = togglePlay;
        window.previousTrack = previousTrack;
        window.nextTrack = nextTrack;
        window.toggleShuffle = toggleShuffle;
        window.toggleRepeat = toggleRepeat;
        window.toggleAutoplay = toggleAutoplay;
        window.seekTo = seekTo;
        window.setVolume = setVolume;
        window.toggleMute = toggleMute;
        window.playPlaylist = playPlaylist;
        window.createPlaylist = createPlaylist;
        window.submitPlaylist = submitPlaylist;
        window.toggleLike = toggleLike;
        window.toggleLikeTrack = toggleLikeTrack;
        window.toggleVoiceControl = toggleVoiceControl;
        window.signInWithGoogle = signInWithGoogle;
        window.signOut = signOut;
        window.togglePremium = togglePremium;
        window.showProfile = showProfile;
        window.updateProfile = updateProfile;
        window.showModal = showModal;
        window.closeModal = closeModal;
        window.filterLibrary = filterLibrary;
        window.showLikedSongs = showLikedSongs;
        window.toggleQueue = toggleQueue;
        window.toggleDevices = toggleDevices;
        window.addToPlaylist = addToPlaylist;
        window.playPlaylistTracks = playPlaylistTracks;
        window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'994aa8a22064a12d',t:'MTc2MTQ4OTEwMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
